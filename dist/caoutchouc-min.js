define("UI/Component/Binding",[],function(){var e=new Class({options:{api:{emit:"trigger"}},_initBinding:function(){var e=this.options.binding;if(!e)return;var t=e._list;for(var n=0;t.length>n;n++){var r=e[t[n]];this.binding=this.binding||{},this._bindObject(r)}return this.binding},_bindObject:function(e){for(var t in e){var n=e[t];typeof n!="object"?this._bindkey(t,n):this._bindList(t,n)}},_bindList:function(e,t){for(var n=0;n<t.length;n++)this._bindkey(e,t[n])},_bindkey:function(e,t){var n=e.split("."),r=n[n.length-1];n.pop();var i=this._path(n.join(".")),s=t.split(".");if(s[s.length-2]==this.options.api.emit){var o=s[s.length-1];this._bindEvent(i,r,o,t)}else this._bindMethod(i,r,t)},_bindEvent:function(e,t,n,r){var i=this.options.api.emit,s=r.split(".");s.splice(-2,2);var o=this._path(s.join("."));e&&e.addEvent&&o&&o.fireEvent?e.addEvent(t,o.fireEvent.bind(o,n)):e&&e.on&&o&&o.fireEvent?e.on(t,o.fireEvent.bind(o,n)):_log.debug("Missing context or method",e,r)},_bindMethod:function(e,t,n){var r=this._path(n),i=n.split(".");i.pop();var s=this._path(i.join("."));e&&e.addEvent&&r?e.addEvent(t,r.bind(s)):e&&e.on&&r&&e.on(t,r.bind(s))},_path:function(e){if(!e)return this;if(!e.match(/\./))return this[e];var t,n=e.split(".");for(var r=0,i=n.length;r<i;r++){var s=n[r];t=t||this,t=t[s]}return t}});return e});
define("UI/Component/Component",["UI/Component/Binding","UI/Component/Method","UI/Component/Location","UI/Component/Drag","UI/Component/Resize"],function(e,t,n,r,i){var s=__debug("ui:component"),o=new Class({Implements:[Events,Options,e,t,n,r,i],name:"component",component:"component",options:{lib:"ui",prefix:"ui-",component:"component",name:"component",type:null,element:{attr:["class","styles","events","id","name","html","title"],tag:"span",type:null}},initialize:function(e){return this.setOptions(e),this.fireEvent("init"),this._initOptions(),this._initElement(),this._initEvents(),this._initBinding(),this},setState:function(e){return this.element.removeClass("state-"+this.state),e&&this.element.addClass("state-"+e),this.state=e,this.fireEvent("state",e),this},addComponent:function(e){s.debug("addComponent",e),e.component||(e.component="container"),e.container=this.element,e.main=this.main;var t=new(UI[e.component.capitalize()])(e);this.addEvent("resize",function(){t.fireEvent("resize")}),this.node.push(t),this.layout[this.main][t.name]=t},_initOptions:function(){var e=this.options;this.main=e.main||e.name,this.layout=e.layout||{},this.layout[this.main]=this.layout[this.main]||{},this.dragHandlers=e.dragHandlers||[]},_initState:function(){this.setState(this.options.state)},_initElement:function(){s.debug("_initElement");var e=this.options;this.fireEvent("create"),this._initElementType();var t=this._initProps(),n=e.tag||e.element.tag,r=new Element(n,t);r.store("_instance",this),this.element=r,this.content=r,this.fireEvent("created"),e.container&&e.container!=="window"&&(this.inject(e.container),this.fireEvent("injected")),this._initState(),this._initClass()},_initProps:function(){s.debug("_initProps");var e=this.options,t={},n=["id","name","type","klass","styles","html","title","events"];for(var r=0;r<n.length;r++){var i=n[r];i==="klass"&&(i="class"),e.element.attr[i]&&(t[i]=e.element.attr[n[r]])}return t},_initElementType:function(){},_initClass:function(){var e=this.options,t=e.klass||e.element.klass;t&&this.element.addClass(t),e.type&&typeOf(e.type)!==undefined&&this.element.addClass("type-"+e.type),e.state&&typeOf(e.state)!==undefined&&this.element.addClass("state-"+e.state)},_initEvents:function(){var e=this,t=this.options;this.addEvents({injected:function(){t.resizable&&e._initResizer&&e._initResizer()},device:function(t){e.device=t}}),this.options.draggable&&this.enableDrag&&this.enableDrag()},getName:function(){return this.options.name||this.name},setHtmlContent:function(e){return this.content.set("html",e),this.fireEvent("loadComplete"),this.fireEvent("resize"),this},setContent:function(e){return this.content.set("html",e),this.fireEvent("resize"),this},inject:function(e,t){return s.debug("inject",e,t),this.fireEvent("inject"),typeOf(e)==="element"?this.container=e:typeOf(e)==="object"&&e.element&&(this.container=e.element),e&&e.component!=="window"&&this.element.inject(this.container,t),this.setSize&&this.setSize(),this.isInjected=!0,this.fireEvent("injected"),this}});return o});
define("UI/Component/Drag",[],function(){var e=new Class({options:{draggable:!1,dragLimitX:!1,dragLimitY:!1,dragHandlers:[],fx:{adaptLocation:{duration:200,wait:!0}}},enableDrag:function(){var e=this;return this.dragHandlers.length===0&&(this.dragHandlers=[]),this.dragHandler=new Drag(this.element,{handle:this.dragHandlers,snap:3,limit:{x:this.options.dragLimitX,y:this.options.dragLimitY},onStart:this.fireEvent.bind(this,"onDragStart"),onDrag:this.fireEvent.bind(this,"onDrag"),onComplete:this.fireEvent.bind(this,"onDragComplete")}),this.addEvent("onDragComplete",function(){e.adaptLocation()}),this},enableElementDrag:function(e){if(e===null)return;return this.dragHandler=new Drag(this.element,{handle:e,snap:3,limit:{x:this.options.dragLimitX,y:this.options.dragLimitY},onStart:this.fireEvent.bind(this,"onDragStart"),onDrag:this.fireEvent.bind(this,"onDrag"),onComplete:this.fireEvent.bind(this,"onDragComplete")}),this.addEvent("onDragComplete",this.adaptLocation.bind(this)),this},disableDrag:function(){return this.dragHandler&&this.dragHandler.detach(),this}});return e});
define("UI/Component/Location",[],function(){var e=new Class({_initLocation:function(){var e=["left","top","right","bottom"],t=this.getInitialLocation();for(var n=0;n<e.length;n++)t[e[n]]&&(this.options[e[n]]=t[e[n]]);this.element.setStyles(t)},setLocation:function(e,t,n){var r=this.options,i=this.element;return this.element.left=e||r.left||i.getCoordinates().x,this.element.top=t||r.top||i.getCoordinates().y,this.element[n?"morph":"setStyles"]({top:this.element.top,left:this.element.left}),this},getCenterLocation:function(){var e={},t=this.options.height;return this.options.height!="auto"?e.top=(window.getHeight()-t.toInt())/2:e.top=160,e.left=(window.getWidth()-this.options.width.toInt())/2,e},getInitialLocation:function(){if(this.options.top||this.options.right||this.options.bottom||this.options.left)return{top:this.options.top,bottom:this.options.bottom,left:this.options.left,right:this.options.right};if(this.options.location=="center")return this.getCenterLocation();var e=ui.window.getCascadeLocation(this);return{top:e.top,left:e.left}},adaptLocation:function(){var e={},t=!1,n=this.element.getCoordinates();n.top.toInt()>window.getHeight()&&(e.top=window.getHeight()-Number.random(25,75),t=!0),n.top.toInt()<0&&(e.top=50,t=!0),n.left.toInt()+this.element.getStyle("width").toInt()<0&&(e.left=Number.random(25,75)-this.element.getStyle("width").toInt(),t=!0),this.element.getStyle("left").toInt()>window.getWidth()&&(e.left=window.getWidth()-Number.random(25,75),t=!0),t&&this.options.fx&&this.options.fx.adaptLocation&&(this.reposFx||(this.reposFx=new Fx.Morph(this.element,this.options.fx.adaptLocation)),this.reposFx.start(e))}});return e});
define("UI/Component/Method",[],function(){var e=new Class({toElement:function(){return this.element},show:function(){return this.fireEvent("show"),this.element.show(),this},hide:function(){return this.fireEvent("hide"),this.element.hide(),this},fade:function(e){return this.fireEvent("fade"),this.element.fade(e),this},getStyle:function(e){return this.element.getStyle(e)},getSize:function(){if(typeOf(this.element)=="object")return this.element.getSize()},getComputedSize:function(){return this.element.getComputedSized()},getCoordinates:function(e){return this.element.getCoordinates(e)},addClass:function(e){return this.element.addClass(e),this},removeClass:function(e){return this.element.removeClass(e)},get:function(e){return this.element.get(e)},morph:function(e){return this.element.morph(e)},setSize:function(e,t){return this.element.x=e||this.options.width,this.element.y=t||this.options.height,this.element.x&&this.element.setStyle("width",this.element.x),this.element.y&&this.element.setStyle("height",this.element.y),this.fireEvent("resize"),this},setStyle:function(e,t){return this.element.setStyle(e,t),this},setStyles:function(e){return this.element.setStyles(e),this},getElement:function(e){return this.element.getElement(e)},getElements:function(e){return this.element.getElements(e)},submit:function(e){return this.element.submit(e)},dispose:function(){return this.element.dispose()},destroy:function(){this.element.destroy();return}});return e});
define("UI/Component/Progress",["UI/Component/Component"],function(e){var t=new Class({Extends:e,options:{name:"progress",klass:"ui-progress",tag:"div"},set:function(e){var t=0,n=e[0]*100/e[1];return n>0&&(t=this.element.getSize().x*n/100),this.bar.setStyle("width",t.toInt()),this.status.set("html",e[0]+" / "+e[1]),this},setStatus:function(e){return this.status.set("html",e),this},_initElement:function(){this.parent(),this.status=(new Element("span",{"class":"progress-status"})).inject(this.element),this.bar=(new Element("div",{"class":"progress-bar"})).inject(this.element)}});return t});
define("UI/Component/Resize",[],function(){var e=new Class({options:{resizer:{"class":"ui-resizer"},resizable:!1,resizeLimitX:[100,screen.width],resizeLimitY:[100,screen.height]},_initResizer:function(){this.resizeHandlers=[];var e=(new Element("div",{"class":"layer-resizer"})).inject(this.element,"bottom");this.resizer=(new Element("div",this.options.resizer)).addEvents({click:function(e){e.stop()},mousedown:function(e){e.stop()}}).inject(e,"bottom"),this.resizeHandlers.push(this.resizer),this.enableResize(0),this.options.resizeBorders&&this.options.resizeBorders.each(function(t,n){this.resizeHandlers.push((new Element("div",{style:t+": 0","class":"ui-resizer-"+t})).addEvents({click:function(e){e.stop()},mousedown:function(e){e.stop()}}).inject(e,"top")),this.enableResize(n+1)},this)},enableResize:function(e){var t=this,n={handle:this.resizeHandlers[e],limit:{x:t.options.resizeLimitX,y:t.options.resizeLimitY},modifiers:{x:"width",y:"height"},onStart:function(e){t.fireEvent("resizeStart",e)},onDrag:function(e,n){t.fireEvent("resizeDrag",[e,n]),t.fireEvent("resize",e)},onComplete:function(e){t.fireEvent("resizeComplete",e)}};if(e===1||e===3)n.modifiers.x=!1;if(e===2||e===4)n.modifiers.y=!1;if(e===1||e===4)this.dragHandlers.push(this.resizeHandlers[e]),n.invert=!0;return this.element.makeResizable(n),this}});return e});
define("UI/Component/Scrollbar",["UI/Component/Component"],function(e){var t=new Class({Extends:e,options:{name:"scrollbar",klass:"ui-scrollbar",type:"track",maxThumbSize:36,wheel:16,autoHide:1e3,size:8},initialize:function(e){this.parent(e),this.bound={start:this.start.bind(this),end:this.end.bind(this),drag:this.drag.bind(this),wheel:this.wheel.bind(this),page:this.page.bind(this)},this.container=this.options.container,this.position={},this.mouse={},this.update(),this.attachEvent()},_initElement:function(){if(!this.options.container)return;this.options.width=this.options.size,this.parent(),this.element.inject(this.options.container,"before"),this.thumb=(new UI.Component({name:"thumb",klass:"ui-thumb"})).inject(this.element)},update:function(){this.containerSize=this.options.container.getSize().y,this.setSize(this.options.width.toInt(),this.containerSize),this.containerScrollSize=this.options.container.scrollHeight,this.trackSize=this.element.offsetHeight.toInt();if(this.containerScrollSize===0)return;this.visible()?this.thumb.element.setStyle("visibility","visible"):this.thumb.element.setStyle("visibility","hidden"),this.containerRatio=this.containerSize/this.containerScrollSize,this.thumbSize=this.trackSize*this.containerRatio;var e;this.thumbSize<this.options.maxThumbSize.toInt()?(e=this.trackSize-(this.options.maxThumbSize.toInt()-this.thumbSize),this.thumbSize=this.options.maxThumbSize.toInt()):this.thumbSize>this.trackSize?this.thumbSize=this.options.maxThumbSize.toInt():e=this.trackSize,this.scrollRatio=this.containerScrollSize/e,this.thumb.setSize(this.options.width,this.thumbSize),this.updateThumbFromContentScroll(),this.updateContentFromThumbPosition();var t=this.element;this.options.autoHide&&(this.timer=function(){t.fade(0)}.delay(this.options.autoHide))},updateContentFromThumbPosition:function(){this.options.container.scrollTop=this.position.now*this.scrollRatio},updateThumbFromContentScroll:function(){clearTimeout(this.timer),this.element.setStyle("opacity","1"),this.position.now=(this.options.container.scrollTop/this.scrollRatio).limit(0,this.trackSize),this.thumb.setStyle("top",this.position.now+"px");var e=this.element;this.options.autoHide&&(this.timer=function(){e.fade(0)}.delay(this.options.autoHide))},attachEvent:function(){this.thumb.element.addEvent("mousedown",this.bound.start),this.options.wheel&&this.options.container.addEvent("mousewheel",this.bound.wheel),this.element.addEvent("mouseup",this.bound.page)},wheel:function(e){var t=this.options;clearTimeout(this.timer),this.element.setStyle("visibility","visible"),t.container.scrollTop-=e.wheel*t.wheel,this.updateThumbFromContentScroll(),this.fireEvent("scrolling",e),e.stop()},page:function(e){var t=this.options,n=t.container;e.page.y>this.thumb.element.getPosition().y?n.scrollTop+=n.offsetHeight:n.scrollTop-=n.offsetHeight,this.updateThumbFromContentScroll(),e.stop()},start:function(e){this.mouse.start=e.page.y,this.position.start=this.thumb.element.getStyle("top").toInt(),document.addEvent("mousemove",this.bound.drag),document.addEvent("mouseup",this.bound.end),this.thumb.element.addEvent("mouseup",this.bound.end),e.stop()},end:function(e){document.removeEvent("mousemove",this.bound.drag),document.removeEvent("mouseup",this.bound.end),this.thumb.element.removeEvent("mouseup",this.bound.end),this.fireEvent("dragCompplete"),e.stop()},drag:function(e){this.mouse.now=e.page.y,this.position.now=(this.position.start+(this.mouse.now-this.mouse.start)).limit(0,this.trackSize-this.thumbSize),this.updateContentFromThumbPosition(),this.updateThumbFromContentScroll(),Math.ceil(this.position.now+this.thumbSize)>=this.trackSize&&(this.options.container.scrollTop=this.containerScrollSize),this.fireEvent("drag",e),e.stop()},visible:function(){return this.containerSize<this.containerScrollSize?!0:!1}});return t});
define("UI/Component/Text",["UI/Component/Component"],function(e){var t=new Class({Extends:e,options:{name:"text",klass:"ui-text",tag:"span",text:"&nbsp;",emboss:!1,selectable:!1},_initElement:function(){this.parent(),this.options.text&&this.set(this.options.text)},set:function(e,t){t===undefined&&(t=e,e="text"),e=="text"&&this.element.set("html",t)}});return t});
define("UI/Component/Toolbar",["mnml/ui/control/base","UI/Component/Component","UI/Control/Button"],function(e,t){var n=UI.Toolbar=new Class({Extends:t,name:"toolbar",options:{base:"component",name:"toolbar"},_initElement:function(){this.parent(),this._initComponent()},_initComponent:function(){var t=this,n=this.options,r=this.element;this.control={},n.comp.klss&&r.addClass(n.comp.klss),r.addClass("toolbar-"+n.comp.name),n.comp.list.each(function(n){_log.debug("---",n,e);var i=e[n];if(i){var s=i.clss||Button,o=i.opts||{};t.control[n]=(new s(o)).inject(r).addEvents({click:function(){t.control[n].isEnable()&&t.fireEvent("emit",n)}})}})}});return n});
define("UI/Container/Container",["UI/Component/Component","UI/Container/Display"],function(e,t){var n=__debug("ui:container"),r=new Class({Extends:e,Implements:[Options,Events,t],name:"container",options:{name:"container",node:null,tag:"div"},initialize:function(e){return this.parent(e),this.options.comp?this._initComp(this.options.comp):this._initComponent(),this},_initElement:function(){this.parent();var e=this.options;this.menu={},e.head&&this._initHead(e.head),e.menu&&this.setMenu(e.menu),this.name==="window"&&this._initBody(),e.useOverlay&&this._initOverlay(),e.foot&&this._initFoot(e.foot);var t=this;this.addEvent("injected",function(){var e=t.container.getStyle("flex-direction");n.debug("direction",e,this.element)}),this.options.useUnderlay&&this._initUnderlay()},_initComponent:function(){var e=this.options;if(e.node===null)return;this.node=[];if(typeOf(e.node)==="array")for(var t=0;t<e.node.length;t++)this.addComponent(e.node[t]);else if(typeOf(e.node)==="object"){var n=e.node;this.addComponent(n)}},_initComp:function(e){var t=this;typeOf(e)==="string"?this.addComp(e):typeOf(e)==="object"?n.debug("object"):typeOf(e)==="array"&&e.each(function(e){t.addComp(e)})},addComp:function(e,t,r){t=t||"bottom",r=r||this.element;if(!r){n.warn("Container is ",r);return}var i=this[e]=(new Element("div")).addClass("container-"+e).inject(r,t);return i},_initClass:function(){this.parent(),this.element.addClass("ui-container")},_initHead:function(){var e=this;this.head=(new Element("div")).addClass("container-head").inject(this.element,"top").addEvent("dblclick",function(){e.fireEvent("max")})},setTitle:function(e){if(this.title&&this.head)return this.title.set("text",e)},getTitle:function(){if(this.title)return this.title.get("html")},_initFoot:function(){this.foot=(new Element("div",{"class":"container-foot"})).inject(this.element,"bottom")},_initStatus:function(e){e=e||"foot",this[e]||this["_init"+e.capitalize()](),this.status=(new Element("div",{"class":"container-status"})).inject(this[e])},_initOverlay:function(){var e=this;this.overlay=(new Element("div",{"class":"container-overlay"})).inject(this.element),this.addEvent("onLoadComplete",function(){this.overlay.hide()}),this.overlay.hide(),this.addEvents({onBlur:function(){e.overlay.show()},onDragComplete:function(){e.overlay.hide()},onDragStart:function(){e.overlay.show()},onResizeComplete:function(){e.overlay.hide(),this.coord=this.element.getCoordinates()},onResizeStart:function(){e.overlay.show()}})},_initUnderlay:function(){var e=this;this.underlay=(new Element("div",{"class":"dialog-underlay",styles:{zIndex:10}})).inject(this.element,"before"),this.underlay.addEvent("click",function(){n.debug("click underlay"),e.minimize()}),this.addEvent("close",function(){e.underlay.destroy()})},focus:function(){this.setState("focus")}});return r});
define("UI/Container/Display",[],function(){var e=__debug("ui-container-display").defineLevel(),t=new Class({options:{display:{fx:{"default":{duration:160,transition:"sine:out",link:"cancel"},minimize:{duration:160,transition:"sine:out",link:"cancel"}}}},_initDisplay:function(){this._modifier="width";var e=this.container.getStyle("flex-direction");e==="column"&&(this._modifier="height");var t=this,n=this.options.display,r=n.fx.default,i=this._modifier;return this[i]||(this[i]=220),this.device=this.device||"desktop",this.display={},r.property=i,this.display.fx=(new Fx.Tween(this.element,r)).addEvent("complete",function(){t.fireEvent("toggled")}),this.display},getDisplay:function(){return this._display},setDisplay:function(e){return this._display=e,this},toggle:function(){return e.debug("toggle click, display:",this._display),this._display==="normalized"?this.minimize():this.normalize(),this._display},minimize:function(){this.display||this._initDisplay(),this.fireEvent("minimize"),this.display.fx.start(0),function(){}.delay(160),this._display="minimized",this.underlay&&this.device!=="desktop"&&this.underlay.fade(0),this.fireEvent("display","minimized")},normalize:function(){this.display||this._initDisplay(),this.fireEvent("normalize");var e=this[this._modifier];this.display.fx?this.display.fx.start(e):this.element.setStyle(this._modifier,e),this.underlay&&this.device!=="desktop"&&(this.underlay.show(),this.underlay.fade(1)),this._display="normalized",this.fireEvent("display","normalized")},maximize:function(){return}});return t});
define("UI/Container/Tab",["UI/Component/Component","UI/Control/Button","UI/Container/Container"],function(e,t,n){var r=new Class({Extends:n,options:{clss:"tab",name:"tab",base:"container",head:!0,content:null,node:[{name:"one"},{name:"two"}],comp:["body"]},initialize:function(e){this.list=[],this.components=[],this.parent(e)},setContent:function(e,t,n){this.active.setContent(e,t,n)},addTab:function(e,n){var r=this,i=e.options,s=i.text||i.name,o=(new t({type:"tab",text:s,name:i.name,onPress:function(t){r.activate(e)}})).inject(this.bar);e.inject(this.body),this.components.push(e),this.components.length==1?this.activate(e):e.hide(),e.element.store("tab",o),this.active==e&&r._setActiveTab(o)},setActive:function(e){if(typeOf(e)=="object"){var t=this.list.indexOf(e);t>=0&&(this.list[t].setState("active"),this.list[num].fireEvent("click"))}},activate:function(e){if(typeOf(e)!="object")return;return this.active&&this.active.hide(),e.show(),e.fireEvent("resize"),this._setActiveTab(e.element.retrieve("tab")),this.active=e,e.fireEvent("resize"),this},_initElement:function(){this.parent(),this._initBar()},_initComponent:function(){var e=this,t=this.options;this.components=[];if(t.node===null)return;this.node=[],this.layout||(this.layout={}),t.node.each(function(t,n){t.component||(t.component="container"),t.container=e.content,t.main=e.main;var r=new(UI[t.component.capitalize()])(t);r.addEvent("focus",function(){e.activate(r)}),e.components.push(r),e.addEvent("resize",function(){r.fireEvent("resize")}),e.node.push(r),n<1&&e.activate(r),e.addTab(r),n>0&&r.hide(),e.layout[e.main][r.name]=r})},_initClass:function(){this.parent(),this.element.addClass("ui-tab")},_initBar:function(){var t=this;this.bar=(new e({tag:"div",klass:"tab-bar",name:"bar"})).inject(this.head,"bottom"),this.addEvent("resize",function(){}.bind(this))},_initEvents:function(){this.parent();var e=this;this.addEvents({resize:function(){e.components.each(function(e){e.fireEvent("resize")})},injected:function(){}})},_setActiveTab:function(e){if(!e)return;this.tab&&(this.tab.element.removeClass("ui-selected"),this.tab.setState("default")),e.addClass("ui-selected"),e.setState("active"),this.tab=e}});return r});
define("UI/Control/Button",["UI/Control/Control","mnml/icon/font","mnml/icon/mdi"],function(e,t,n){var r=__debug("ui:control-button"),i=new Class({Extends:e,name:"button",options:{name:"button",type:null,ink:!0,element:{tag:"span"},binding:{_list:["element"],element:{"sensor.click":"_onClick","sensor.dblclick":"_onDblClick","sensor.mousedown":"_onMouseDown","sensor.mouseup":"_onMouseUp","sensor.mouseleave":"_onMouseLeave"}}},set:function(){},_initElement:function(){this.parent();var e=this.options,t=e.type;e.text=e.text||e.n,t===null&&(t="icon-text"),e.name&&this.element.set("data-name",e.name),r.debug("title",this.element,e.text),this.element.set("title",e.text),e.icon&&this._initIcon(t,e.icon||e.name),e.text&&this._initText(t),e.ink?this._initSensor():this.sensor=this.element},_initIcon:function(e,i){r.debug("_initIcon",e,i);var s="span",o=i,u=null,a={"class":"ui-icon"};this.icon=(new Element(s,a)).inject(this.element),n[i]?(u="icon-mdi",o=n[i]):t[i]&&(u="icon-font",o=t[i]),u&&this.icon.addClass(u),o&&this.icon.addClass(o)},_initText:function(e){var t=this.options,n="span",r="bottom";e==="text-icon"&&(r="top"),this.text=(new Element(n,{"class":"ui-text",html:t.text})).inject(this.element,r)},_initClass:function(){var e=this.options;this.options.isPrimary&&this.element.addClass("is-primary"),this.options.klss&&this.element.addClass(e.klss),this.options.type&&this.element.addClass("type-"+this.options.type),this.element.addClass(e.prefix+this.name),this.options.clss&&this.element.addClass(this.options.clss)},_initSensor:function(){r.debug("_initSensor");var e="div";this.sensor=(new Element(e,{"class":"ui-sensor"})).inject(this.element)},_touchInk:function(e,t,n,r){var i=r.height,s=0,o=1e3;this.ink=e,r.width>i&&(i=r.width,s=(r.height-r.width)/2);var u=new Fx.Morph(e,{duration:o,link:"chain",transition:Fx.Transitions.Quart.easeOut});u.start({height:i,width:i,left:0,top:s,opacity:0}),function(){e.destroy()}.delay(o)},_onClick:function(e){r.debug("_onElementClick",e);var t=this.options;e.stopPropagation(),t.emit&&this.state!=="disabled"&&this.fireEvent(t.emit),this.fireEvent("press",t.emit),this.fireEvent("pressed",t.emit),t.call&&this.state!=="disabled"&&t.call()},_onDblClick:function(e){var t=this.options;e.stop(),t.emit&&this.state!=="disabled"&&this.fireEvent("dblpress",t.emit),this.fireEvent("dblpressed",t.emit)},_onMouseDown:function(e){e.stop();if(this.state==="disabled")return;var t=e.event.offsetX,n=e.event.offsetY,r=this.element.getCoordinates(this.element),i=this.ink=(new Element("span",{"class":"ui-ink",styles:{left:t,top:n}})).inject(this.element,"top");this._touchInk(i,t,n,r),this.fireEvent("mousedown")},_onMouseLeave:function(e){r.debug("_onMouseLeave",e)},_onMouseEnter:function(e){r.debug("_onElementMouseDown",e)},_onMouseUp:function(e){r.debug("_onElementMouseUp",e),this.options.type==="check"&&(this.state==="checked"?this.setState(null):this.setState("checked"))}});return i});
define("UI/Control/ButtonMenu",["UI/Control/Button","UI/Control/Separator","mnml/icon/font"],function(e,t){var n=__debug("ui:control-buttonMenu"),r=new Class({Extends:e,name:"button",options:{name:"button",type:"action"},_initElement:function(){this.parent(),n.debug("_initElement"),this.control={}},_initMenu:function(e){n.debug("_initMenu",e);var t=null;n.debug(e.list,this.element),e.list=e.list||[],this.container=$(this.element).getParent();var r=this.menu=(new Element("ul",{"class":"button-menu"})).addEvents({mouseleave:function(){clearTimeout(t),t=setTimeout(function(){r.setStyle("display","none")},500)},mouseenter:function(){clearTimeout(t)},click:function(){r.setStyle("display","none")}}).inject(this.container,"bottom");for(var i=0;i<e.list.length;i++){var s=e.list[i],o=e[s];this._initItem(s,o,this.menu)}var u=this._initMenuPosition();this.menu.setStyles({top:u.top,right:u.right}),n.debug(this.menu)},_initMenuPosition:function(){var e=this.element.getCoordinates(this.container);return e},_initItem:function(e,r,i){var s=this,o="UI/Control/Button",u;r=r||{};var a=e.split(/\:\:/);e=a[0],a.splice(0,1),e==="separator"&&(o="UI/Control/Separator"),r.clss&&(o=r.clss);var f=t[r.icon||e]||"mdi-action-help";n.debug("_initItem",e,f),r.opts?(u=r.opts,u.text=r.text||Locale.get("control."+e,e)||e,u.icon=f,u.tag="span"):u={name:e,icon:f};if(!e)return;if(o==="UI/Control/Button"||o==="UI/Control/ButtonMenu")u.text=r.text||Locale.get("control."+e,e)||e;this._requireModule(o,function(t){s.control[e]=(new t(u)).inject(i),o==="UI/Control/Button"&&s.control[e].addEvents({press:function(){var e=this.options.name;n.debug("press",e,this.isEnable()),this.isEnable()&&s.fireEvent("press",e),s.menu.hide()}})})},_requireModule:function(e,t){n.debug("_requireModule",e);if(typeOf(e)==="class"){t(e);return}require([e],function(e){t(e)},function(e){n.error(e),t()})},_onClick:function(e){n.debug("_onElementClick");var t=this.options;e.stopPropagation(),this.menu||this._initMenu(t),this.menu.setStyle("display","block")}});return r});
define("UI/Control/Check",["UI/Control/Field"],function(e){var t=new Class({Extends:e,name:"check",options:{text:null,checked:!1,error:!1,opts:{type:"ckeck"}},_initElement:function(){this.parent();var e=this,t=this.options;this.checked=t.value,this.input.set("type","hidden");var n=t.opts;this.wrapper=(new Element("div",{"class":"check-wrapper"})).inject(this.element),this._initText(t),this._initCheck(t),this._initError(),this.checked&&this.check.addClass("checked")},_initCheck:function(){var e=this,t=this.check=(new Element("span",{"class":"control-check"})).inject(this.wrapper);this.readonly||t.addEvents({click:function(){e.checked?(e.checked=!1,this.removeClass("checked")):(e.checked=!0,this.addClass("checked")),e.fireEvent("change",e.checked)}}),this.on=(new Element("span",{"class":"check-text check-on",html:"oui"})).inject(t),this.knob=(new Element("span",{"class":"ckeck-knob",html:"&nbsp;"})).inject(t),this.off=(new Element("span",{"class":"check-text check-off",html:"non"})).inject(t)},_initText:function(e){var t=this;this.text=(new Element("span",{"class":"control-text",html:e.text})).addEvents({click:function(){t.checked?(t.checked=!1,this.removeClass("checked")):(t.checked=!0,this.addClass("checked")),t.fireEvent("change",t.checked)}}).inject(this.wrapper)}});return t});
define("UI/Control/Choice",["UI/Control/Field"],function(e){var t=new Class({Extends:e,options:{name:"choice"},_initElement:function(){this.parent(),this.item={};var e=this,t=this.options;this.input.set("type","text"),this.input.addClass(t.klss),this.element.addClass("ui-choice"),this.wrapper=(new Element("div",{"class":"choice-wrapper"})).inject(this.label,"after"),this.choice=(new Element("span",{"class":"choice-text",html:t.value})).inject(this.wrapper),this._initList(t.list),t.value&&this.input.set("value",t.value)},_initList:function(e){var t=this;this.list=(new Element("ul",{"class":"choice-list"})).inject(this.label,"after"),this.itemList=[];if(e&&e.length>0)for(var n=0;n<e.length;n++)this._initItem(e[n])},_initItem:function(e){var t=this,n=this.options,r=(new Element("li",{html:e,"data-value":e})).inject(this.list).addEvent("click",function(){if(n.read)return;t.selected&&t.selected.removeClass("selected"),t.selected&&t.selected===this?(t.selected.removeClass("selected"),t.selected=null,n.type==="push"&&t.select()):(this.addClass("selected"),t.selected=this,t.select(e))});this.item[e]=r,this.itemList.push(e),n.value===e&&(r.addClass("selected"),t.selected=r)},toggle_selected:function(){this.selected&&this.selected.removeClass("selected"),this.selected&&this.selected===this?(this.selected.removeClass("selected"),this.selected=null):(this.addClass("selected"),this.selected=this)},select:function(e){var t=this.options.name;this.input.set("value",e),this.choice.set("html",e),this.element.removeClass("state-open"),this.fireEvent("change",e,t)},set:function(e){var t=this.item[e];if(!t)return;this.selected&&this.selected.removeClass("selected"),t.addClass("selected"),this.selected=t},_toggle:function(){this.element.hasClass("state-open")?this.element.removeClass("state-open"):this.element.addClass("state-open")},_initEvents:function(){this.parent();var e=this}});return t});
define("UI/Control/Color",["UI/Control/Choice"],function(e){var t=new Class({Extends:e,options:{name:"choice"},_initElement:function(){this.parent(),this.element.addClass("choice-color")},_initItem:function(e){var t=this,n=this.options,r=(new Element("li",{"class":e})).inject(this.list).addEvent("click",function(){t.selected&&t.selected.removeClass("selected"),t.selected&&t.selected==this?(t.selected.removeClass("selected"),t.selected=null,t.select(null)):(this.addClass("selected"),t.selected=this,t.select(e))}),i=(new Element("span",{html:"&nbsp;"})).inject(r);this.itemList.push(r),n.value==e&&(r.addClass("selected"),t.selected=r)},set:function(e){var t=this.itemList;for(var n=0;n<t.length;n++){var r=t[n];r.hasClass(e)?r.addClass("selected"):r.removeClass("selected")}}});return t});
define("UI/Control/Control",["UI/Component/Component"],function(e){var t=__debug("ui:control"),n=new Class({Extends:e,options:{error:!1},isEnable:function(){return this.state==="disabled"?!1:!0},isActive:function(){return this.state==="active"?!0:!1},_initOptions:function(){this.parent();var e=this.options;this.value=e.value,this.readonly=e.read},_initEvents:function(){var e=this;this.element.addEvents({click:function(n){t.debug("click",n),e.fireEvent("click")},mouseup:function(){e.fireEvent("mouseup")}})}});return n});
define("UI/Control/Currency",["UI/Control/Field"],function(e){var t=new Class({Extends:e,options:{name:"currency",base:"control"},_initElement:function(){this.parent(),this.input.addClass("mask"),this.input.set("alt","{ type:'number', groupSymbol: ',', groupDigits: 3, decSymbol: '', decDigits: 0,	stripMask: false}"),this.element.addClass("field-currency")}});return t});
define("UI/Control/Date",["require","exports","module","moment","UI/Control/Field","DatePicker/Locale.en-US.DatePicker","DatePicker/Picker.Date"],function(e,t,n){var r=e("moment"),i=e("UI/Control/Field");e("DatePicker/Locale.en-US.DatePicker"),e("DatePicker/Picker.Date");var s=__debug("ui-control-date").defineLevel(),o=new Class({Extends:i,options:{name:"date",base:"control",tag:"div",type:"input",format:"ddd, MMM D YYYY",value:null,useTextAsLabel:!1,picker:{useFadeInOut:!1,draggable:!1,columns:1,positionOffset:{x:0,y:5},pickerClass:"datepicker_bootstrap",format:"b"}},_initInput:function(){var e=this.options;s.debug("input option",e.read,e.name),this.element.addClass("field-date"),this.element.addClass("icon-text"),this.input=(new Element("input",{name:e.name,type:"text","class":"date-input"})).inject(this.element),e.read&&this.input.set("readonly","readonly"),e.read||this._initPicker(),this.text=(new Element("input",{"class":"date-text",type:"text"})).inject(this.element),this.set(e.value)},_initPicker:function(){var e=this,t=this.options,n=t.picker;n.pickOnly=this.options.pickOnly||!1,n.onShow=function(){s.debug("picker date show");var t=e.text.get("value");e.input.setStyle("visibility","hidden"),e.input.set("value",t),setTimeout(function(){e.set(t),e.input.setStyle("visibility","initial")},0)},n.onHide=function(){s.debug("picker date hide")},this.picker=new Picker.Date(this.input,n)},_initEvents:function(){if(this.options.read)return;var e=this;this.picker.addEvents({select:function(t){e.set(t),e.fireEvent("change",t)}})},set:function(e){s.debug("set",e);if(!e)return;var t=this.options,n=r(e).format(t.format),i=r(e).toISOString();this.picker.options.pickOnly==="months"&&(n=r(e).format("MMMM YYYY")),this.input.set("value",n),this.input.set("placeholder",t.text),this.text.set("value",i)}});n.exports=o});
define("UI/Control/Dates",["UI/Component/Component"],function(e){var t=new Class({Extends:e,options:{name:"dates",base:"control"},_initElement:function(){this.parent(),this.date=this.options.date;var e=new Date(this.date),t=this.convertDateTimeToHour(e);this.input.set("value",t),this.input.set("type","text"),this.input.addClass("control-hour");var n=this;this.addEvent("injected",function(){n._addControls()})},_addControls:function(){var e=this,t=(new Element("span",{"class":"hour-controls"})).inject(this.input,"after");this.plus=(new Element("span",{"class":"icon-plus"})).inject(t),this.plus.addEvent("click",function(){tmp=(new Date(e.date)).increment("minute","15").toJSON(),e.date=(new Date(e.date)).increment("minute","15");var t=e.convertDateTimeToHour(tmp);e.input.set("value",t),e.fireEvent("change",e.date)}),this.minus=(new Element("span",{"class":"icon-minus"})).inject(t),this.minus.addEvent("click",function(){tmp=(new Date(e.date)).decrement("minute","15").toJSON(),e.date=(new Date(e.date)).decrement("minute","15");var t=e.convertDateTimeToHour(tmp);e.input.set("value",t),e.fireEvent("change",e.date)})},convertDateTimeToHour:function(e){var t=new Date(e),n=t.getHours().toString(),r=t.getMinutes().toString();return n.length==1&&(n="0"+n),r.length==1&&(r+="0"),n+"h"+r},setState:function(e){this.parent(e)},_initEvents:function(){this.parent(),this.addEvents({blur:this.setState.bind(this,"default"),focus:this.setState.bind(this,"focus")})},set:function(e,t){this.element.set(e,t)}});return t});
define("UI/Control/Dropdown",["utils/api","UI/Control/Field","UI/Control/Button","UI/Control/ButtonMenu"],function(e,t,n,r){var i=__debug("ui:control-dropdown").defineLevel(),s=new Class({Extends:t,name:"dropdown",options:{name:"dropdown",type:"text",menuFx:{duration:150,link:"chain",transition:Fx.Transitions.Quart.easeOut},binding:{_list:["input","button"],input:{"input.mousedown":"_onMouseDown","input.keydown":"_onKeyDown","input.keyup":"_onKeyUp"},button:{"button.press":"_onButtonPress"}}},_initElement:function(){this.parent(),this.control={},this.element.addClass("type-dropdown");var e=this.options;this.readonly||(this._initMenu(e),this._initButton(),this._initEvents())},_onKeyDown:function(e){i.debug("KeyDown");if(e.key!=="tab"){e.stop();return}if(this.readonly){e.stop();return}},_onKeyUp:function(e){i.debug("_onKeyUp",e)},_initButton:function(){i.debug("_initButton"),this.button=(new n({clss:"right",type:"icon",name:"movedown",icon:"mdi-hardware-keyboard-arrow-down"})).inject(this.element,"top")},_onButtonPress:function(e){i.debug("_onButtonClick",e),this.isFocused?this._showMenu():this.input.focus()},_onMouseDown:function(e){this.parent(e),this._onButtonPress(e)},_initMenu:function(e){var t=this,n=null;e.list=e.list||[],this.container=this.element.getParent();var r=t.input.get("value"),i=this.menu=(new Element("ul",{"class":"ui-menu"})).inject(this.element,"bottom").addEvents({mouseleave:function(){clearTimeout(n),n=setTimeout(function(){i.setStyle("display","none")},500)},mouseenter:function(){clearTimeout(n)},click:function(){i.setStyle("display","none")}});for(var s=0;s<e.list.length;s++){var o=e.list[s],u=e.list[o];this._initItem(o,u,this.menu,r)}return this.menuFx=new Fx.Morph(this.menu,e.menuFx),i},_initEvents:function(){var e=this;if(this.readonly)return;this.addEvents({select:function(t){e.input.set("value",t),e.fireEvent("change",t)}})},_onFocus:function(e){this._showMenu(e),this.parent(e)},_onBlur:function(e){this.parent(e),this._hideMenu(e)},_showMenu:function(){if(this.readonly)return;var e=this.menu;e.setStyles({height:0,left:16,paddingTop:0,paddingBottom:0,display:"block",opacity:0});var t=this.input.getCoordinates(this.element),n=t.height+t.top;e.setStyle("top",n);var r=t.width;e.scrollWidth>t.width&&(r=e.scrollWidth),e.setStyle("width",r),this.menuFx.start({height:this.menu.scrollHeight+22,paddingTop:10,paddingBottom:10,opacity:1}),this.fireEvent("showMenu",e)},_hideMenu:function(){if(this.input.get("readonly"))return;this.menuFx.start({height:0,paddingTop:0,paddingBottom:0,opacity:0});var e=this;(function(){e.menu.setStyle("display","none")}).delay(this.options.menuFx.duration),this.fireEvent("hide")},_initMenuPosition:function(){var e=this.element.getCoordinates(this.container);return e},_initItem:function(t,s,o,u){var a=this,f=n,l,c=t.split(/\./);c.length>1&&(f="UI."+c[0].capitalize(),t=c[1]),t==="separator"&&(f=Separator),s&&s.clss&&(f=s.clss),s&&s.opts?(l=s.opts,i.debug("--",t,s.opts),l.text=Locale.get("control."+t,t)||t,l.tag="span"):l={name:t},this.value===t&&(l.klss="is-selected");if(!t)return;var h=e.strToClss(f);if(f===n||f===r)l.text=Locale.get("control."+t,t)||t;this.options.control=this.options.control||{},this.control[t]=(new h(l)).inject(o),f===n&&this.control[t].addEvents({press:function(){var e=this.options.name;this.isEnable()&&(a.value=e,a.fireEvent("select",e)),a.menu.hide()}})},_onClick:function(e){var t=this.options;e.stopPropagation(),this.menu||this._initMenu(t),this.menuShow(e)}});return s});
define("UI/Control/Field",["UI/Control/Control"],function(e){var t=__debug("ui:control-field"),n=new Class({Extends:e,options:{name:"field",base:"control",tag:"div",type:"input",value:null,error:!0,useTextAsLabel:!1,inkFx:{duration:200,link:"chain",transition:Fx.Transitions.Quart.easeOut},binding:{_list:["input"],input:{"input.keyup":"_onKeyUp","input.keydown":"_onKeyDown","input.mousedown":"_onMouseDown","input.focus":"_onFocus","input.blur":"_onBlur"}}},_initElement:function(){this.parent();var e=this.options;t.debug("_initElement",e.name,e.klss),this.element.addClass("ui-field"),e.klss&&this.element.addClass(e.klss),e.label!==!1&&this._initLabel(),this._initInput(),e.error&&this._initError()},_initLabel:function(){var e=this.options.name;this.options.useTextAsLabel&&(e=this.options.text),this.label=(new Element("label",{html:e,"for":this.options.name})).inject(this.element)},_initInput:function(){return this.input=(new Element("input",{name:this.options.name,type:this.options.type,value:this.options.value,placeholder:this.options.text})).inject(this.element),this.readonly&&(this.input.set("readonly","readonly"),this.input.set("tabindex","-1")),this.input},_initName:function(e){var t=this.options;t.name&&(this.label.set("html",e),this.input.set("name",e))},_initValue:function(){var e=this.options;e.value&&this.setValue(e.value)},getValue:function(){return this.input.get("value")},setValue:function(e){this.input.set("value",e),this.value=e,this.fireEvent("change",e)},_initEvents:function(){this.parent(),this.addEvents({blur:this.setState.bind(this,"default"),focus:this.setState.bind(this,"focus")})},_onKeyUp:function(e){this.fireEvent("change",this.get("value"))},onKeyDown:function(e){if(this.readonly){e.stop();return}this.fireEvent("change",this.get("value"))},_onMouseDown:function(e){if(this.readonly)return;this.isFocused=!0,this.setState("focus"),this._inputFocus(e)},_onFocus:function(e){if(this.readonly)return;this.isFocused=!0,this.setState("focus"),this._inputFocus(e)},_onBlur:function(e){if(this.readonly)return;this.setState(null),this._hideInk(),this.isFocused=!1},_inputFocus:function(e){this.fireEvent("mousedown"),this._showInk(e),this.isFocused=!0},_initInk:function(){var e=this.options;this.ink=(new Element("span",{"class":"field-ink"})).inject(this.element),this.inkFx=new Fx.Morph(this.ink,e.inkFx)},_showInk:function(e){if(this.readonly)return;var t=this.input.getCoordinates(this.element),n=t.width/2;e===0?n=0:e&&e.event&&e.event.offsetX&&(n=e.event.offsetX);var r=t.width,i=0;this.ink||this._initInk(),this.ink.setStyles({left:n}),this.inkFx.start({width:r,top:t.top+t.height-2,bottom:"initial",left:t.left,opacity:1})},_setInk:function(e){if(this.readonly)return;var t=this.input.getCoordinates(this.element),n=t.width/2,r=t.width,i=0;this.ink||this._initInk(),this.inkFx.set({width:r,top:t.top+t.height-2,bottom:"initial",left:t.left,opacity:1})},_hideInk:function(){var e=this,t=this.input.getCoordinates(this.element),n=t.width/2;if(!this.inkFx)return;this.inkFx.start({width:0,left:n,top:t.top+t.height-2,bottom:"initial",opacity:0}),function(){e.ink&&(e.ink.destroy(),e.ink=null)}.delay(100)},_initError:function(){this.error=(new Element("span",{"class":"error-message"})).inject(this.element)},set:function(e){this.input.set("value",e),this.fireEvent("change",e)},setError:function(e){e?(this.element.addClass("field-error"),this.error&&this.error.set("html",e)):(this.error&&this.element.removeClass("field-error"),this.error&&this.error.set("html",""))}});return n});
define("UI/Control/Hour",["moment","UI/Control/Field"],function(e,t){var n=new Class({Extends:t,options:{name:"hour",base:"control"},_initElement:function(){this.parent(),this.options.read||(this.input.addClass("mask"),this.input.set("alt","{ type: 'fixed', mask: '99h99' }")),this.element.addClass("field-hour"),this.date=this.options.value||this.options.date;var e;if(this.date){var t=new Date(this.date);e=this.convertDateTimeToHour(t)}this.input.set("value",e),this.input.set("type","text"),this.input.addClass("control-hour");var n=this;this.addEvent("injected",function(){n._addControls()})},_addControls:function(){var e=this,t=(new Element("span",{"class":"hour-controls"})).inject(this.input,"after");this.plus=(new Element("span",{"class":"icon-font mdi-navigation-expand-less icon-more"})).inject(t),this.plus.addEvent("click",function(){var t=(new Date(e.date)).increment("minute","15").toJSON();e.date=(new Date(e.date)).increment("minute","15");var n=e.convertDateTimeToHour(t);e.input.set("value",n),e.fireEvent("change",e.date)}),this.minus=(new Element("span",{"class":"icon-font mdi-navigation-expand-more icon-less"})).inject(t),this.minus.addEvent("click",function(){var t=(new Date(e.date)).decrement("minute","15").toJSON();e.date=(new Date(e.date)).decrement("minute","15");var n=e.convertDateTimeToHour(t);e.input.set("value",n),e.fireEvent("change",e.date)})},convertDateTimeToHour:function(e){var t=new Date(e),n=t.getHours().toString(),r=t.getMinutes().toString();return n.length===1&&(n="0"+n),r.length===1&&(r="0"+r),n+"h"+r},setState:function(e){this.parent(e)},_initEvents:function(){var e=this;if(this.options.read)return;this.input.addEvents({keyup:function(){var t=this.get("value").split("h");e.date=new Date(e.date),e.date.setHours(t[0]),e.date.setMinutes(t[1]),e.date.setSeconds(0),e.fireEvent("change",e.date)},mousedown:function(e){},focus:function(t){this.get("readonly")||e.setState("focus",t)},blur:function(t){e.setState(null,t)}}),this.addEvents({blur:this.setState.bind(this,"default"),focus:this.setState.bind(this,"focus")})},_onKeyUp:function(e){},setOld:function(e,t){this.element.set(e,t)},set:function(t){this.date=e(t).toISOString();var n=this.convertDateTimeToHour(this.date);this.input.set("value",n),this.fireEvent("change",this.date)}});return n});
define("UI/Control/Input",["UI/Control/Control"],function(e){var t=new Class({Extends:e,options:{name:"ui-input",value:""},_initElement:function(){this.parent(),_log.debug("_initElement",this),this.setInput("text"),this.input.setStyle("width",this.props.width-this.input.getStyle("paddingLeft").toInt()-this.input.getStyle("paddingRight").toInt())},setState:function(e){this.parent(e),this.skin[e]&&this.input.set(this.skin[e].components.input.styles)},_initEvents:function(){this.parent(),this.addEvents({blur:this.setState.bind(this,"default"),focus:this.setState.bind(this,"focus")})}});return t});
define("UI/Control/Item",["UI/Control/Control"],function(e){var t=new Class({Extends:e,name:"item",options:{name:"button",type:null,ink:!0,element:{tag:"span"},binding:{_list:["element"],element:{"sensor.click":"_onClick","sensor.dblclick":"_onDblClick","sensor.mousedown":"_onMouseDown","sensor.mouseup":"_onMouseUp","sensor.mouseleave":"_onMouseLeave"}}},set:function(){},_initElement:function(){this.parent();var e=this.options,t=e.type;e.text=e.text||e.n,t===null&&(t="icon-text"),e.name&&this.element.set("data-name",e.name),this.element.set("title",e.text),e.icon&&this._initIcon(t),e.text&&this._initText(t),e.ink?this._initSensor():this.sensor=this.element},_initIcon:function(e){var t=this.options,n="span",r={"class":"button-icon"};this.icon=(new Element(n,r)).inject(this.element);var i=t.icon.replace("icon-","fa-");this.icon.addClass("fa"),this.icon.addClass(i)},_initText:function(e){var t=this.options,n="span",r="bottom";e=="text-icon"&&(r="top"),this.text=(new Element(n,{"class":"button-text",html:t.text})).inject(this.element,r)},_initClass:function(){var e=this.options;this.options.klss&&this.element.addClass("button-"+e.klss),this.options.type&&this.element.addClass("type-"+this.options.type),this.element.addClass(e.prefix+this.name),this.options.clss&&this.element.addClass(this.options.clss)},_initSensor:function(e){var t=this.options,n="div";this.sensor=(new Element(n,{"class":"button-sensor"})).inject(this.element)},_touchInk:function(e,t,n,r){var i=r.height,s=0,o=1e3;this.ink=e,r.width>i&&(i=r.width,s=(r.height-r.width)/2);var u=new Fx.Morph(e,{duration:o,link:"chain",transition:Fx.Transitions.Quart.easeOut});u.start({height:i,width:i,left:0,top:s,opacity:0}),function(){e.destroy()}.delay(o)},_onClick:function(e){_log.debug("_onElementClick",e);var t=this.options;e.stopPropagation(),t.emit&&this.state!="disabled"&&this.fireEvent(t.emit),this.fireEvent("press",t.emit),this.fireEvent("pressed",t.emit),t.call&&this.state!="disabled"&&t.call()},_onDblClick:function(e){var t=this.options;e.stop(),t.emit&&this.state!="disabled"&&this.fireEvent("dblpress",t.emit),this.fireEvent("dblpressed",t.emit)},_onMouseDown:function(e){_log.debug("_onElementMouseDown",e),e.stop();var t=e.event.offsetX,n=e.event.offsetY;coord=this.element.getCoordinates(this.element);var r=this.ink=(new Element("span",{"class":"button-ink",styles:{left:t,top:n}})).inject(this.element,"top");this._touchInk(r,t,n,coord),this.fireEvent("mousedown")},_onMouseLeave:function(e){_log.debug("_onMouseLeave",e)},_onMouseEnter:function(e){_log.debug("_onElementMouseDown",e)},_onMouseUp:function(e){_log.debug("_onElementMouseUp",e);var t=this.options;this.options.type=="check"&&(this.state=="checked"?this.setState(null):this.setState("checked"))}});return t});
define("UI/Control/Multi",["UI/Control/Field"],function(e){var t=new Class({Extends:e,options:{name:"choice"},_initElement:function(){this.parent();var e=this,t=this.options;this.value=t.value||[],this.input.set("type","text"),this.input.addClass(t.klss),this.element.addClass("ui-choice"),this.wrapper=(new Element("div",{"class":"choice-wrapper"})).inject(this.element),this.choice=(new Element("span",{"class":"choice-text",html:t.value})).inject(this.wrapper),this._initList(t.list)},_initList:function(e){var t=this;this.menu=(new Element("ul",{"class":"choice-list"})).inject(this.element);if(e&&e.length>0)for(var n=0;n<e.length;n++)this._initItem(e[n])},_initItem:function(e){var t=this,n=this.options,r=(new Element("li",{html:e})).inject(this.menu).addEvent("click",function(){if(this.hasClass("selected")){this.removeClass("selected");var r=t.value.indexOf(e);_log.debug(r,e),r>-1&&t.value.splice(r,1)}else this.addClass("selected"),t.value.push(e);_log.debug(t.value),t.fireEvent("change",{value:t.value,key:n.name})});this.value&&this.value.indexOf(e)>-1&&r.addClass("selected")},toggle:function(){_log.debug("toggle_selected",this.element),this.selected&&this.selected.removeClass("selected"),this.selected&&this.selected==this?(this.selected.removeClass("selected"),this.selected=null):(this.addClass("selected"),this.selected=this)},_select:function(e){var t=this.options.name;this.input.set("value",e),this.choice.set("html",e),this.element.removeClass("state-open"),this.fireEvent("change",e,t)},_toggle:function(){this.element.hasClass("state-open")?this.element.removeClass("state-open"):this.element.addClass("state-open")},_initEvents:function(){this.parent();var e=this;this.choice.addEvents({click:this._toggle.bind(this,"default")})}});return t});
define("UI/Control/Radio",[],function(){var e=UI.RadiosGroup=new Class({Extends:UI.Control,options:{name:"radiosgroup",name:"radio"},initialize:function(e){return this.parent(e),this.radios=[],this.selectedRadio=!1,this},newRadio:function(e){var t=(new Element("span",{"class":"ui-radio",styles:Object.merge({},{position:"relative",display:"inline-block",height:15,zIndex:this.radios.length+1},e.styles)})).store("value",e.value);this.radios.push(t),this.radios[1]||(this.control=t,this.setInput());if(e.text){var n=(new UI.Text({skin:this.options.skin,"for":this.options.name,html:e.text})).inject(t);t.setStyle("width",100)}return e.selected&&!this.selectedRadio&&(this.selectedRadio=t,this.input.value=t.retrieve("value"),this.setState(t,"selected")),this.addRadioAction(t),t},addRadioAction:function(e){e.addEvents({click:function(){this.selectedRadio&&this.setState(this.selectedRadio,"default"),this.setState(e,"selected"),this.selectedRadio=e,this.input.value=e.retrieve("value")}.bind(this)})},setState:function(e,t){e.paint.draw(this.skin[t])}});return e});
define("UI/Control/Search",["UI/Control/Field","UI/Control/Button","UI/Component/Method","mnml/icon/font"],function(e,t,n,r){var i=new Class({Extends:e,Implements:[Options,Events,n],options:{name:"search",error:!1,label:!1,timer:100},initialize:function(e){this.setOptions(e);var t=this.options;return this.fireEvent("init"),this._initOptions(t),this._initElement(),this._initEvents(),this},_initElement:function(){this.parent();var e=this.options;this.element.addClass("ui-search"),this._initReset()},_initInput:function(){this.parent(),this.input.set("autocomplete","off")},_initReset:function(){var e=this,n=r.clear||"mdi-action-help";this.reset=(new t({name:"clear",icon:n})).inject(this.element).addEvent("press",function(){e.empty()})},_initEvents:function(){this.parent();var e=this,t=this.options,n;this.input.addEvents({keyup:function(){clearTimeout(n),n=setTimeout(function(){e.fireEvent("search",e.input.get("value"))},t.timer)},mousedown:function(e){e.stopPropagation()}})},focus:function(){return this.input.focus(),this.fireEvent("focus"),this},empty:function(){return this.input.set("value",""),this.fireEvent("reset"),this}});return i});
define("UI/Control/Select",["UI/Control/Field"],function(e){var t=new Class({Extends:e,options:{name:"select",opts:{type:"select",showValue:!0}},_initElement:function(){this.parent();var e=this;this.input.set("type","hidden");var t=this.options.opts;this.menu=(new UI.Menu(t)).addEvents({change:function(t){e.input.set("value",t),e.fireEvent("change",t),e.setState("close")}}).inject(this.element),this.options.value&&e.menu.head.set("html",this.options.value)}});return t});
define("UI/Control/Separator",["UI/Control/Control"],function(e){var t=new Class({Extends:e,name:"separator",options:{name:"separator",type:null,element:{tag:"span"},binding:{_list:["element"],element:{"element.mousedown":"_onElementMouseDown","element.click":"_onElementClick","element.dblclick":"_onElementClick"}}},set:function(){},_initElement:function(){this.parent();var e=this.options,t=e.type;this.options.clss&&this.element.addClass(this.options.clss)},_initClass:function(){var e=this.options;this.options.klss&&this.element.addClass("button-"+e.klss),this.options.type&&this.element.addClass("type-"+this.options.type),this.element.addClass(e.prefix+this.name)},_onElementMouseDown:function(e){_log.debug(),this.fireEvent("mousedown"),e.stop()},_onElementClick:function(e){var t=this.options;e.stopPropagation(),t.emit&&this.state!="disabled"&&this.fireEvent(t.emit),this.fireEvent("press",t.emit),this.fireEvent("pressed",t.emit),t.call&&this.state!="disabled"&&t.call()},_onElementMouseUp:function(){var e=this.options;this.options.type=="check"&&(this.state=="checked"?this.setState(null):this.setState("checked"))}});return t});
define("UI/Control/Slider",[],function(){var e=UI.Slider=new Class({Extends:UI.Component,options:{name:"slider",type:"horizontal",onStart:function(){},onChange:function(){},onComplete:function(){},onTick:function(){},snap:!1,offset:0,range:!1,wheel:!1,steps:100},initialize:function(e){this.parent(e)},_initElement:function(){this.parent(),this.handler=(new UI.Component({skin:this.options.skin,name:"slider",type:"knob"})).inject(this.element)},inject:function(e,t){this.fireEvent("inject");var n=this;return this.element.inject(e,t),this.element.setStyle("visibility","visible"),this.setSize(),this.setCanvas(),this.slider=new Slider(this.paint.canvas,this.handler.element,{snap:this.options.snap,offset:this.options.offset,range:this.options.range,wheel:this.options.wheel,steps:this.options.steps,mode:this.options.type,onStart:function(e){n.fireEvent("start",e)},onTick:function(e){this.options.snap&&(e=this.toPosition(this.step)),this.knob.setStyle(this.property,e)},onChange:function(e){n.fireEvent("change",e)},onComplete:function(e){n.fireEvent("complete",e)}}),this.fireEvent("injected"),this},_initEvents:function(){this.parent(),this.addEvent("complete",function(e){this.value=e})},set:function(e){return this.slider.set(e)}});return e});
define("UI/Control/Steps",["UI/Control/Field"],function(e){var t=new Class({Extends:e,options:{name:"steps"},_initElement:function(){this.parent(),this.item={};var e=this.options;this.input.set("type","text"),this.input.addClass(e.klss),this.element.addClass("ui-steps"),this.wrapper=(new Element("div",{"class":"steps-wrapper"})).inject(this.element),this.steps=(new Element("span",{"class":"steps-text",html:e.value})).inject(this.wrapper),this._initList(e.list),e.value||(e.value=1),e.value&&this.input.set("value",e.value)},_initList:function(e){this.list=(new Element("ul",{"class":"steps-list"})).inject(this.element),this.itemList=[];if(e&&e.length>0)for(var t=0;t<e.length;t++)this._initItem(e[t],t+1)},_initItem:function(e,t){var n=this,r=this.options,i=(new Element("li",{"data-value":e})).inject(this.list).addEvent("click",function(){n.fireEvent("step",t),n.fireEvent(e)});(new Element("span",{html:t,"class":"step-index"})).inject(i),this.options.opts=this.options.opts||{};var s=this.options.opts.text||{},o=s[e]||e;(new Element("span",{html:o,"class":"step-label"})).inject(i),this.item[e]=i,this.itemList.push(e),r.value===e&&(i.addClass("selected"),n.selected=i),r.value===e&&(i.addClass("selected"),n.selected=i)},_initError:function(){},set:function(e){var t=this.item[e];if(!t)return;this.selected&&this.selected.removeClass("selected"),t.addClass("selected"),this.selected=t}});return t});
define("UI/Control/Textarea",["UI/Control/Field"],function(e){var t=__debug("ui:textarea"),n=new Class({Extends:e,options:{name:"textarea",name:"ui-input",value:"",binding:{_list:["input","button"],input:{"input.mousedown":"_onMouseDown","input.keydown":"_updateInk","input.keyup":"_updateInk"},button:{"button.press":"_onButtonPress"}}},_initInput:function(){t.debug("_initInput");var e=this.options,n=this.input=(new Element("textarea",{name:e.name,placeholder:e.text,type:e.type,value:e.value})).inject(this.element);this.readonly&&(this.input.set("readonly",!0),this.input.set("tabeindex","-1")),e.klss&&this.input.addClass(e.klss),this._initAutogrow(n)},_initAutogrow:function(e){var t=this;clearTimeout(this.autogrowTimeout),this.autogrowTimeout=setTimeout(function(){var t=new Form.AutoGrow(e,{minHeightFactor:1});e.store("autogrow",t),e.addEvent("focus",function(){t.resize()})},200)},_updateInk:function(e){if(this.readonly){e.stop();return}this._setInk&&this._setInk(1)},_initEvents:function(){this.parent(),this.addEvents({blur:this.setState.bind(this,"default"),focus:this.setState.bind(this,"focus")})}});return n});
define("UI/Control/Tool",[],function(){var e=UI.Tool=new Class({Extends:UI.Container,name:"tool",options:{base:"component",name:"tool",content:!0,type:null,menu:{tag:"ul"},item:{component:"button",options:{tag:"li",klass:"list-item"}},trigger:"click",timerOnHide:500,hideOnCall:!0},initialize:function(e){return this.setOptions(e),this.timer=null,this.options.type=="drop"?this.state="close":this.state="open",this.item={},this.menus=[],this._initElement(),this._initComponent(),this._initEvents(),ui.menu.register(this),this},_initElement:function(){var e=this,t=this.options;this.element=new Element("div",{"class":"ui-menu",zIndex:t.zIndex}),this.element.addClass("menu-"+t.name),t.klss&&this.element.addClass(t.klss),t.type&&this.element.addClass("type-"+t.type),this._initHead(t.head),this.content=(new Element("ul",{"class":"menu-list"})).inject(this.element),this.addEvents({show:function(){e.content.getStyle("display","block")},hide:function(){e.content.getStyle("display","none")}}),t.open&&(this.display=this.content.getStyle("display","block")),this.element.addEvent("click",function(e){e.stop()})},_initHead:function(){var e=this,t=this.options;trigger=t.trigger;if(!t.head)return;head=(new Element("div",{"class":"menu-head",html:t.head.text})).inject(this),head.addEvent(trigger,function(){e.toggle()}),this.addEvents({show:function(){this.head.addClass("open")},hide:function(){this.head.removeClass("open")},change:function(n){t.showValue&&e.head&&e.head.set("html",n)}}),t.head.klss&&head.addClass(t.head.klss),this.head=head},_initComponent:function(){var e=this,t=this.options,n=t.menu,r=this.content;n.each(function(n,r){n.text||(n.text=null);var i=t.item.component.capitalize(),s=Object.merge(t.item.options,n),o=new UI[i](s);e.item[n.name]=o,n.klss&&o.element.addClass(n.klss),n.type&&o.addClass("type-"+n.type),n.state&&o.setState(n.state),this.menus.push(n),n.selected&&e.select(o),n.call?o.element.addEvents({click:function(n){e.fireEvent("change",this.get("name")),e.fireEvent("select",this),t.type=="drop"&&t.hideOnCall&&e.hideNow(),e.name=="context"&&e.hideNow()}}):n.emit?o.element.addEvents({click:function(t){t.stop(),e.fireEvent(n.emit)}}):o.element.addEvents({click:function(r){r.stop();if(e.state=="disabled")return;e.value=this.get("name"),e.fireEvent("change",this.get("name")),e.fireEvent("selectItem",n),t.type=="push"?e.fireEvent("select",this):t.type=="drop"&&e.hideNow()}}),o.inject(this.content)},this)},_initEvents:function(){var e=this,t=this.options;t.type=="drop"&&t.timerOnHide&&this.element.addEvents({mouseleave:function(){e.hide()},mouseenter:function(){clearTimeout(e.timer)}}),t.type=="push"&&this.addEvents({select:function(t){e.select(t.get("name"))}})},select:function(e){if(e===!1||e===null){this.selected&&(this.selected.removeClass("state-active"),this.selected.removeClass("state-checked"));return}typeOf(e)=="string"&&(e=this.element.getElement('[name="'+e+'"]'));if(!e)return;this.selected&&this.selected.removeClass("state-active"),e.addClass("state-active"),this.selected=e},unselect:function(e){var t=this;typeOf(e)=="string"&&(e=this.element.getElement('[name="'+e+'"]'));if(!e)return;t.selected&&(t.selected=null),e.removeClass("state-active"),e.removeClass("state-checked")},deselect:function(){if(!this.selected)return;this.selected.removeClass("state-active"),this.selected.removeClass("state-checked")},getSelected:function(){},toggle:function(){this.state=="open"?this.setState("close"):this.setState("open"),this.fireEvent("toggle")},toggleFold:function(){this.state=="folded"?this.setState("unfolded"):this.setState("floded"),this.fireEvent("toggle")},hide:function(){clearTimeout(this.timer),this.timer=function(){this.close()}.delay(this.options.timerOnHide,this)},hideNow:function(){this.close()},shut:function(){this.setState("close"),this.fireEvent("closed")},close:function(){this.setState("close"),this.fireEvent("closed")},open:function(){this.setState("open"),this.fireEvent("opened")}});return e});
define("UI/Control/URL",["UI/Control/Field"],function(e){var t=new Class({Extends:e,options:{name:"URL",base:"control",tag:"div",type:"input",value:null,useTextAsLabel:!1},initialize:function(e){this.setOptions(e);var t=this.options;return this.fireEvent("init"),this._initOptions(t),this._initElement(),this._initEvents(),this},_initElement:function(){this.parent();var e=this.options;this.element.addClass("ui-field"),e.klss&&this.element.addClass(e.klss),e.label!=0&&this._initLabel(),this._initInput()},_initLabel:function(){var e=this.options.name;this.options.useTextAsLabel&&(e=this.options.text),this.label=(new Element("label",{html:e})).inject(this.element)},_initInput:function(){var e=this;this.input=(new Element("input",{name:this.options.name,type:this.options.type,value:this.options.value,placeholder:this.options.text})).inject(this.element),this.input.addEvents({keyup:function(){e.fireEvent("change",this.get("value"))},mousedown:function(e){e.stopPropagation()}})}});return t});
define("UI/Control/Upload",["UI/Control/Button"],function(e){var t=__debug("ui:control-upload"),n=new Class({Extends:e,name:"button",options:{name:"upload",type:null,ink:!1,element:{tag:"button","class":"type-action"}},_initElement:function(){t.debug("upload"),this.parent();var e=this.options;this._initFile(e.type)},_initFile:function(){var e=this,n=(new Element("input",{type:"file",name:"upload",id:"upload",multiple:"multiple"})).inject(this.element);n.addEvent("change",function(e){t.debug("change mootools",e)}),n.onchange=function(n){t.debug("onchage native",n,this.files);var r=this.files;r&&(t.debug("fireevent uploadFile",r),e.fireEvent("uploadFile",[r]))},this.addEvent("injected",function(){})}});return n});
define("UI/Layout/Component",["utils/api"],function(e){var t=__debug("ui:layout").defineLevel(),n=new Class({options:{resizer:{modifier:{row:{size:"width",from:"left",mode:{y:!1}},column:{size:"height",from:"top",mode:{x:!1}}}}},_initComponent:function(n){t.debug("_initComponent",n.opts.name,n),n.opts.flex=n.opts.flex||n.flex,n.opts.hide=n.opts.hide||n.hide,n.opts.theme=n.opts.theme||n.theme;var r=n.opts.name,i=e.strToClss(n.clss),s=this.component[r]=this[r]=new i(n.opts);return this._componentRegister(r,s),this._initComponentSettings(s),this._setComponentStyles(s),this._setComponentDisplay(s),this._attachComponentEvents(s),s},_componentRegister:function(e,t){this.components=this.components||[],this.components.push(t)},_initComponentSettings:function(e){t.debug("_initcompSettings",e)},_setComponentStyles:function(e){t.debug("_setComponentStyles",e),e.options.flex&&e.element.addClass("flex-"+e.options.flex),e.options.hide&&e.element.setStyle("display","none"),e.options.theme&&e.element.addClass("theme-"+e.options.theme)},_setComponentDisplay:function(e){t.debug("comp opts",e.options);var n=e.getName(),r=e.element,i=this.settings[n],s="normalized";i&&i.display&&(s=i.display),e.setDisplay(s,"width"),e.options.flex||(i&&e.options.axis==="x"?(r.addClass("flex-none"),s==="minimized"?r.setStyle("width",0):(i.width<32&&(i.width=32),r.setStyle("width",i.width||null)),e.width=i.width||260,e._modifier="width"):i&&e.options.axis==="y"&&(r.setStyle("flex","none"),r.setStyle("height",i.height||null),e.height=i.height||260,e._modifier="height"),this._initResizer(e))},_attachComponentEvents:function(e){var t=this,n=e.getName();e.addEvents({toggled:function(){t.fireEvent("resize")},resizing:function(){t.fireEvent("resize")},display:function(e){t.fireEvent("display",[n,e])}}),this.addEvents({resize:function(){e.fireEvent("resize")},drag:function(){e.fireEvent("resize")},normalize:function(){e.fireEvent("resize")},maximize:function(){e.fireEvent("resize")},minimize:function(){e.fireEvent("resize")},device:function(t){e.fireEvent("device",t)}})}});return n});
define("UI/Layout/Layout",["UI/Container/Container","UI/Layout/Component","UI/Layout/Resize"],function(e,t,n){var r=__debug("ui:layout"),i=new Class({Implements:[Events,Options,t,n],options:{name:"layout",clss:e,settings:{}},initialize:function(e){return this.setOptions(e),this._initLayout(this.options),this},_initLayout:function(e){r.debug("initialize",e);var t=e.node;this.settings=e.settings||{},this.component={},this.components=[],this.resizer={},this._initContainer(e),this._processComponents(t),this._initEvents()},_initEvents:function(e){var t=this;window.addEvent("resize",function(){var e=t.container.getCoordinates();e.width<720&&t.navi&&t.navi.minimize(),t.fireEvent("drag")}),function(){t.fireEvent("drag")}.delay(1e3)},_initContainer:function(t){this.container=(new e({resizable:!1,"class":"ui-layout layout-"+t.node._name})).inject(t.container),this.container.addClass("ui-layout"),this.container.addClass("layout-"+t.node._name),this.options.theme&&this.container.addClass("theme-"+this.options.theme),t.node.container=this.container},_processComponents:function(e,t,n){var r=e._list||[];n=n++||1,t!=="tab"&&(e._axis=this._initFlexDirection(e.container,e._axis));for(var i=0;i<r.length;i++){var s=r[i],o=e[s]||{};o.clss=o.clss||this.options.clss,o.opts=o.opts||{},o.opts.name=s,o.opts.position=i+1,o.opts.axis=e._axis,o.opts.nComp=r.length,s==="navi"&&(o.opts.useUnderlay=!0),i===r.length-1&&(o.opts.last=!0),t!=="tab"&&(o.opts.container=e.container);var u=this._initComponent(o);t==="tab"&&(u.options.noResizer=!0,e.container.addTab(u)),u.element.addClass("container-"+s),o.node&&(o.node.container=u,u.options.clss==="tab"?this._processComponents(o.node,"tab",n):this._processComponents(o.node,null,n))}},_initFlexDirection:function(e,t){if(!e)return;return t=t||"x",t==="x"?e.addClass("flex-horizontal"):t==="y"&&e.addClass("flex-vertical"),t},setDevice:function(e){this.device=e,this.fireEvent("device",e)}});return i});
define("UI/Layout/Resize",[],function(){var e=new Class({options:{resizer:{modifier:{row:{size:"width",from:"left",mode:{y:!1}},column:{size:"height",from:"top",mode:{x:!1}}}}},_initResizer:function(e){var t=this,n=e.options.name,r=e.element,i=e.container,s=e.options.last;this._initMaximize(e);if(!i)return;var o=i.getStyle("flex-direction");if(!o)return;var u=this.options.resizer.modifier[o];if(!u)return;var a=this.resizer[n]=(new Element("div",{"class":"ui-resizer","data-name":e.options.name})).addEvents({click:function(e){e.stop()},mousedown:function(e){e.stop()}}).inject(i);u.size&&a.addClass("resizer-"+u.size),s,this._initResizerDrag(a,u,e),this._initResizerEvent(e,a,u),this.fireEvent("drag")},_initResizerDrag:function(e,t,n){var r=this,i=n.element,s=n.container,o=n.options.last,u=new Drag.Move(e,{modifiers:t.mode,onStart:function(e){},onDrag:function(n,u){var a=i.getCoordinates(s),f=s.getCoordinates(),l=e.getCoordinates(s);o?i.setStyle(t.size,f[t.size]-l[t.from]):i.setStyle(t.size,l[t.from]-a[t.from]),r.fireEvent("drag")},onComplete:function(e){var o=i.getCoordinates(s),u=i.getCoordinates(s)[t.size];r.fireEvent("resizer",[n.main,t.size,u]),n.fireEvent("resizeComplete",[t.size,u]),n[t.size]=u}});return u},_initResizerEvent:function(e,t,n){var r=this;this.addEvents({drag:function(i){r._updateSize(e,t,n)},maximize:function(){r._updateSize(e,t,n)},normalize:function(){r._updateSize(e,t,n)},resize:function(){r._updateSize(e,t,n)}})},_updateSize:function(e,t,n){var r=e.container,i=e.element,s=i.getCoordinates(r);e.options.last?t.setStyle(n.from,s[n.from]-3):t.setStyle(n.from,s[n.from]+s[n.size]-3),this.fireEvent("size")},_initMaximize:function(e){var t=this,n=e.element,r=e.container;if(!r)return;e.addEvent("max",function(){var i=e.options.name;_log.debug("max",e),n.hasClass("container-max")?(n.removeClass("container-max"),r.getChildren(".ui-container").each(function(e){e.setStyle("display",e.retrieve("display"))}),n.setStyle("width",n.retrieve("width")),n.setStyle("height",n.retrieve("height")),t.fireEvent("normalize",e)):(n.addClass("container-max"),n.store("width",n.getStyle("width")),n.store("height",n.getStyle("height")),n.setStyle("width","initial"),n.setStyle("height","initial"),r.getChildren(".ui-container").each(function(e){e.hasClass("container-"+i)||(e.store("display",e.getStyle("display")),e.hide())}),t.fireEvent("resize",e))})},_initResizers:function(e){var t=e.length;for(var n=0;n<t;n++){var r=e[n];if(r.options.noResizer)continue;this._initResizer(r)}}});return e});
define("UI/Menu/Context",["UI/Menu/Menu"],function(e){var t=__debug("ui-menu-context").defineLevel(),n=new Class({Extends:e,name:"context",options:{name:"context",scope:$(document.body),container:$(document.body),trigger:"contextmenu",zIndex:20,underlay:!1},initialize:function(e){t.debug("initialize",e),this.parent(e);var n=this.options;return n.underlay&&this._initUnderlay(),this.element.inject(n.container),this._initContext(),this},_initElement:function(){t.debug("_initElement");var e=this,n=this.options;this.element=(new Element("div",{"class":"ui-context",styles:{zIndex:n.zIndex+10}})).addEvents({mousediown:function(t){e.fireEvent("mousedown"),t.stop()}}),this.element.addClass("context-"+n.name),n.klss&&this.element.addClass(n.klss),n.type&&this.element.addClass("type-"+n.type),this._initHead(n.head),this.content=(new Element("ul",{"class":"menu-list"})).inject(this.element),this.addEvents({show:function(){t.debug("show"),e.content.getStyle("display","block")},hide:function(){t.debug("hide"),e.content.getStyle("display","none")}}),this.element.addEvent("click",function(e){e.stop()}),this.element.hide()},_initContext:function(){var e=this,t=this.options,n=t.scope||t.container;return n.getElements(t.target).each(function(t){e.addTarget(t)}),this},_initUnderlay:function(){var e=this,n=this.options,r=this.underlay=(new Element("div",{"class":"context-underlay",styles:{zIndex:n.zIndex}})).addEvents({click:function(){t.debug("click"),r.setStyle("display","none"),e.element.hide()}}).inject(n.container);this.addEvents({show:function(){t.debug("show"),r.setStyle("display","block")}})},addList:function(){},addTarget:function(e){var t=this;e.addEvent(t.options.trigger,function(e){e.stop(),e.preventDefault(),t.target=e.target,t.show(e)})},removeList:function(){},_initEvents:function(){this.parent(),this.addEvents({show:function(){t.debug("show")},hide:function(){t.debug("hide")}})},removeContexts:function(){return this.els.each(function(e){e.removeEvents("contextmenu")}),this},setPosition:function(e,t){var n=this.options,r=n.container;if(e===null||t===null)return;var i=r.getPosition().y,s=this.element.getCoordinates(),o=t-i,u=e+r.getScrollLeft();e+s.width>r.getWidth()&&(u-=s.width),t+s.height>r.getHeight()&&(o-=s.height),this.element.setStyles({top:o,left:u})},hide:function(){t.debug("hide"),clearTimeout(this.timer),this.timer=function(){this.close()}.delay(this.options.timerOnHide,this)},hideNow:function(){this.element.hide()},show:function(e){return t.debug("show",this),this.fireEvent("show",e.target),this.element.show(),this.setPosition(e.client.x,e.client.y),this}});return n});
define("UI/Menu/ContextTool",[],function(){var e=UI.ContextTool=new Class({Extends:UI.Menu,name:"context",options:{name:"context",scope:$(document.body),container:$(document.body),trigger:"contextmenu"},initialize:function(e){this.parent(e),_log.debug(this.options.container,this.element),this.element.inject(this.options.container),this._initContext()},_initElement:function(){var e=this,t=this.options;_log.debug("UI.MEnu._initElement()",t),this.element=new Element("div",{"class":"ui-context",zIndex:t.zIndex,display:"none"}),this.element.addClass("context-"+t.name),t.klss&&this.element.addClass(t.klss),t.type&&this.element.addClass("type-"+t.type),this._initHead(t.head),this.content=(new Element("ul",{"class":"menu-list"})).inject(this.element),this.addEvents({show:function(){e.content.getStyle("display","block")},hide:function(){e.content.getStyle("display","none")}}),this.element.addEvent("click",function(e){e.stop()}),this.element.hide()},_initContext:function(){var e=this;opts=this.options,scope=opts.scope||$(document.body),_log.debug(scope,scope.getElements(opts.target));var t=e.options.trigger+":relay("+opts.target+")";return _log.debug(t),scope.addEvent(t,function(t){t.stop(),t.preventDefault(),t.stopPropagation(),e.target=t.target,e.show(t)}),this},addList:function(){},removeList:function(){},_initEvents:function(){this.parent(),this.addEvents({show:function(){ui.menu.hideAll()}})},removeContexts:function(){return this.els.each(function(e){e.removeEvents("contextmenu")}),this},setPosition:function(e,t){var n=this;opts=this.options,container=opts.container;if(e===null||t===null)return;var r=container.getPosition();_log.debug(r,e,t);var t=t-r.y,i=this.element.getCoordinates(container),s=t,o=e+this.options.container.getScrollLeft();e+i.width>this.options.container.getWidth()&&(o-=i.width),t+i.height>this.options.container.getHeight()&&(s=s),this.element.setStyles({top:s,left:o})},hide:function(){clearTimeout(this.timer),this.timer=function(){this.close()}.delay(this.options.timerOnHide,this)},hideNow:function(){this.element.hide()},show:function(e){this.fireEvent("show",e.target),this.element.show();var t=this.content.getCoordinates();return this.setPosition(e.client.x,e.client.y),this}});return e});
define("UI/Menu/Menu",["UI/Window/controller","UI/Container/Container","UI/Control/Button"],function(e,t,n){var r=__debug("ui-menu").defineLevel(),i=new Class({Extends:t,Implements:[Options,Events],name:"menu",options:{base:"component",name:"menu",content:!0,type:null,menu:{tag:"ul"},item:{component:"button",options:{tag:"li",klass:"list-item"}},trigger:"click",timerOnHide:500,hideOnCall:!0},initialize:function(e){return r.debug("menu init",e),this.setOptions(e),this.timer=null,this.options.type==="drop"?this.state="close":this.state="open",this.item={},this.menus=[],this._initElement(),this._initComponent(),this._initEvents(),this},_initController:function(){ui.menu||(this.controller=ui.menu=e)},_initElement:function(){r.debug("_initElement",t);var e=this,t=this.options;this.element=new Element("div",{"class":"ui-menu",zIndex:t.zIndex}),this.element.addClass("menu-"+t.name),t.klss&&this.element.addClass(t.klss),t.type&&this.element.addClass("type-"+t.type),this._initHead(t.head),this.content=(new Element("ul",{"class":"menu-list"})).inject(this.element),this.addEvents({show:function(){r.debug("show"),e.content.getStyle("display","block")},hide:function(){r.debug("hide"),e.content.getStyle("display","none")}}),t.open&&(this.display=this.content.getStyle("display","block")),this.element.addEvent("click",function(e){e.stop()})},_initHead:function(){var e=this,t=this.options,n=t.trigger;if(!t.head){r.warn("missing opts.head",t);return}var i=(new Element("div",{"class":"menu-head",html:t.head.text})).inject(this);i.addEvent(n,function(){e.toggle()}),this.addEvents({show:function(){r.debug("show"),this.head.addClass("open")},hide:function(){r.debug("hide"),this.head.removeClass("open")},change:function(n){r.debug("change",n),t.showValue&&e.head&&e.head.set("html",n)}}),t.head.klss&&i.addClass(t.head.klss),this.head=i},_initComponent:function(){var e=this,t=this.options,i=t.menu;r.debug("_initComponent",i),i.each(function(i){i.text||(i.text=null);var s=t.item.component.capitalize(),o=i;r.debug("_initComponent component",s);var u=new n(o);e.item[i.name]=u,i.klss&&u.element.addClass(i.klss),i.type&&u.addClass("type-"+i.type),i.state&&u.setState(i.state),this.menus.push(i),i.selected&&e.select(u),i.call?u.element.addEvents({click:function(n){r.debug("click event menu",t.type),e.fireEvent("change",this.get("data-name")),e.fireEvent("select",this),t.type==="drop"&&t.hideOnCall&&e.hideNow(),e.name==="context"&&e.hideNow()}}):i.emit?u.element.addEvents({click:function(t){r.debug("click"),t.stop(),e.fireEvent(i.emit)}}):u.element.addEvents({click:function(n){r.debug("click event menu"),n.stop();if(e.state==="disabled")return;r.debug("click",t.type),e.value=this.get("data-name"),e.fireEvent("change",this.get("data-name")),e.fireEvent("selectItem",i),t.type==="push"?(r.debug("select",this),e.fireEvent("select",this)):t.type==="drop"&&e.hideNow()}}),u.inject(this.content)},this)},_initEvents:function(){r.debug("_initEvents",this.options.name);var e=this,t=this.options;t.type==="drop"&&t.timerOnHide&&this.element.addEvents({mouseleave:function(){e.hide()},mouseenter:function(){clearTimeout(e.timer)}}),t.type==="push"&&this.addEvents({select:function(t){r.debug("select",t.get("data-name")),e.select(t.get("data-name"))}})},select:function(e){r.debug("select",e);if(e===!1||e===null){this.selected&&(this.selected.removeClass("state-active"),this.selected.removeClass("state-checked"));return}typeOf(e)==="string"&&(e=this.element.getElement('[data-name="'+e+'"]'));if(!e)return;this.selected&&this.selected.removeClass("state-active"),e.addClass("state-active"),this.selected=e},unselect:function(e){r.debug("unselect");var t=this;typeOf(e)==="string"&&(e=this.element.getElement('[name="'+e+'"]'));if(!e)return;t.selected&&(t.selected=null),e.removeClass("state-active"),e.removeClass("state-checked")},deselect:function(){r.debug("deselect");if(!this.selected)return;this.selected.removeClass("state-active"),this.selected.removeClass("state-checked")},getSelected:function(){},toggle:function(){r.debug("toggle"),this.state==="open"?this.setState("close"):this.setState("open"),this.fireEvent("toggle")},toggleFold:function(){r.debug("toggleFold"),this.state==="folded"?this.setState("unfolded"):this.setState("floded"),this.fireEvent("toggle")},hide:function(){r.debug("hide"),clearTimeout(this.timer),this.timer=function(){this.close()}.delay(this.options.timerOnHide,this)},hideNow:function(){r.debug("hideNow"),this.close()},shut:function(){r.debug("shut"),this.setState("close"),this.fireEvent("closed")},close:function(){r.debug("close"),this.setState("close"),this.element.setStyle("display","none"),this.fireEvent("closed")},open:function(){r.debug("open"),this.setState("open"),this.fireEvent("opened")}});return i});
define("UI/Menu/Tool",[],function(){var e=UI.Tool=new Class({Extends:UI.Container,name:"menu",options:{base:"component",name:"menu",content:!0,type:null,menu:{tag:"ul"},item:{component:"button",options:{tag:"li",klass:"list-item"}},trigger:"click",timerOnHide:500,hideOnCall:!0},initialize:function(e){return this.setOptions(e),this.timer=null,this.options.type=="drop"?this.state="close":this.state="open",this.item={},this.menus=[],this._initElement(),this._initComponent(),this._initEvents(),ui.menu.register(this),this},_initElement:function(){var e=this,t=this.options;this.element=new Element("div",{"class":"ui-menu",zIndex:t.zIndex}),this.element.addClass("menu-"+t.name),t.klss&&this.element.addClass(t.klss),t.type&&this.element.addClass("type-"+t.type),this._initHead(t.head),this.content=(new Element("ul",{"class":"menu-list"})).inject(this.element),this.addEvents({show:function(){e.content.getStyle("display","block")},hide:function(){e.content.getStyle("display","none")}}),t.open&&(this.display=this.content.getStyle("display","block")),this.element.addEvent("click",function(e){e.stop()})},_initHead:function(){var e=this,t=this.options;trigger=t.trigger;if(!t.head)return;head=(new Element("div",{"class":"menu-head",html:t.head.text})).inject(this),head.addEvent(trigger,function(){e.toggle()}),this.addEvents({show:function(){this.head.addClass("open")},hide:function(){this.head.removeClass("open")},change:function(n){t.showValue&&e.head&&e.head.set("html",n)}}),t.head.klss&&head.addClass(t.head.klss),this.head=head},_initComponent:function(){var e=this,t=this.options,n=t.menu,r=this.content;n.each(function(n,r){n.text||(n.text=null);var i=t.item.component.capitalize(),s=Object.merge(t.item.options,n),o=new UI[i](s);e.item[n.name]=o,n.klss&&o.element.addClass(n.klss),n.type&&o.addClass("type-"+n.type),n.state&&o.setState(n.state),this.menus.push(n),n.selected&&e.select(o),n.call?o.element.addEvents({click:function(n){e.fireEvent("change",this.get("name")),e.fireEvent("select",this),t.type=="drop"&&t.hideOnCall&&e.hideNow(),e.name=="context"&&e.hideNow()}}):n.emit?o.element.addEvents({click:function(t){t.stop(),e.fireEvent(n.emit)}}):o.element.addEvents({click:function(r){r.stop();if(e.state=="disabled")return;e.value=this.get("name"),e.fireEvent("change",this.get("name")),e.fireEvent("selectItem",n),t.type=="push"?e.fireEvent("select",this):t.type=="drop"&&e.hideNow()}}),o.inject(this.content)},this)},_initEvents:function(){var e=this,t=this.options;t.type=="drop"&&t.timerOnHide&&this.element.addEvents({mouseleave:function(){e.hide()},mouseenter:function(){clearTimeout(e.timer)}}),t.type=="push"&&this.addEvents({select:function(t){e.select(t.get("name"))}})},select:function(e){if(e===!1||e===null){this.selected&&(this.selected.removeClass("state-active"),this.selected.removeClass("state-checked"));return}typeOf(e)=="string"&&(e=this.element.getElement('[name="'+e+'"]'));if(!e)return;this.selected&&this.selected.removeClass("state-active"),e.addClass("state-active"),this.selected=e},unselect:function(e){var t=this;typeOf(e)=="string"&&(e=this.element.getElement('[name="'+e+'"]'));if(!e)return;t.selected&&(t.selected=null),e.removeClass("state-active"),e.removeClass("state-checked")},deselect:function(){if(!this.selected)return;this.selected.removeClass("state-active"),this.selected.removeClass("state-checked")},getSelected:function(){},toggle:function(){this.state=="open"?this.setState("close"):this.setState("open"),this.fireEvent("toggle")},toggleFold:function(){this.state=="folded"?this.setState("unfolded"):this.setState("floded"),this.fireEvent("toggle")},hide:function(){clearTimeout(this.timer),this.timer=function(){this.close()}.delay(this.options.timerOnHide,this)},hideNow:function(){this.close()},shut:function(){this.setState("close"),this.fireEvent("closed")},close:function(){this.setState("close"),this.fireEvent("closed")},open:function(){this.setState("open"),this.fireEvent("opened")}});return e});
define("UI/Menu/controller",[],function(){var e={options:{version:"0.1",zBase:300,zStep:2},list:[],zIndex:300,register:function(e){this.list.push(e),e.options.zIndex=="auto"?e.element.setStyle("zIndex",this.zIndex):e.element.setStyle("zIndex",e.options.zIndex),this.zIndex+=this.options.zStep},close:function(e){e=e||this.active,e.hide(),e.fireEvent("onClose");for(var t=this.list.length-1;t>=0;t--)this.list[t]==e&&(e.destroy(),delete this.list[t],this.list=this.list.clean());this.focus()},focus:function(e){},closeall:function(){this.list.each(function(e){},this)},hideAll:function(){this.list.each(function(e){e.hideNow()},this)}};return e});
define("UI/Selector/Border",[],function(){var e=new Class({Implements:[Events,Options],options:{container:document.body,type:"solid",clss:"selector-border",zIndex:2,size:1,color:"#000",opacity:"1",location:"outside"},initialize:function(e,t){this.setOptions(t),this.container=e,this.lines=[],this._initElement()},_initElement:function(){var e=[[],[],[],[]];e.each(function(e){this.buildBorder()},this)},buildBorder:function(){var e=this,t=(new Element("div",{"class":this.options.clss})).addClass("type-"+e.options.type).setStyles({zIndex:this.options.zIndex,backgroundColor:this.options.color,opacity:this.options.opacity}).addEvent("click",function(){e.fireEvent("click")}).inject(this.container,"top");t.set("morph",{duration:250,transition:"expo:out",link:"cancel"}),this.lines.push(t)},reach:function(e){if(!e){if(!this.el)return;e=this.el}else this.el=e;var t=[],n=[],r=this.options.size,i=e.getCoordinates();if(this.options.positionning=="relative"){var s=e.getPosition(this.container);i.left=s.x,i.right=s.x+i.width,i.top=s.y,i.bottom=s.y+i.height}return this.options.location=="inside"?t=[[i.top,i.left,i.right-i.left-r,r],[i.top,i.right-r,r,i.bottom-i.top],[i.bottom-r,i.left+r,i.right-i.left-2*r,r],[i.top+r,i.left,r,i.bottom-i.top-r]]:t=[[i.top-r,i.left-r,i.right-i.left+2*r,r],[i.top,i.right,r,i.bottom-i.top],[i.bottom,i.left-r,i.right-i.left+2*r,r],[i.top,i.left-r,r,i.bottom-i.top]],this.lines.each(function(e,n){this._setLinePosition(e,t[n])},this),this.fireEvent("selected"),this},addClass:function(e){this.lines.each(function(t,n){t.addClass(e)},this)},removeClass:function(e){this.lines.each(function(t,n){t.addClass(e)},this)},_setLinePosition:function(e,t){this.options.usefx?e.morph({"margin-top":t[0],"margin-left":t[1],width:t[2],height:t[3]}):e.setStyles({"margin-top":t[0],"margin-left":t[1],width:t[2],height:t[3]})},set:function(e,t){return selector?self[selector][e](t):this.selectors.each(function(n){self[n][e](t)}),this},setColor:function(e){this._setStyle("backgroundColor",e)},setOpacity:function(e){this._setStyle("opacity",e)},_setStyle:function(e,t){return this.lines.each(function(n){n.setStyle(e,t)}),this},setStyles:function(e){return this.lines.each(function(t){t.setStyles(e)}),this},hide:function(){return this._setStyle("display","none"),this},show:function(){return this._setStyle("display","block"),this},highlight:function(e){return this.lines.each(function(t){t.highlight(e)}),this},remove:function(){return this.lines.each(function(e){e.destroy()}),this}});return e});
define("UI/Selector/Mask",[],function(){var e=new Class({Implements:[Events,Options],options:{container:document.body,clss:"selector-mask",type:"solid",zIndex:1,offset:0,color:"rgba(255,255,255,.8)",opacity:"1",location:"outside"},initialize:function(e,t){this.setOptions(t),this.container=e,this.masks=[],this._initElement()},_initElement:function(){var e=[[],[],[],[]];e.each(function(e){this.buildMask()},this)},buildMask:function(){var e=this,t=(new Element("div",{"class":this.options.clss})).addClass("type-"+e.options.type).setStyles({zIndex:this.options.zIndex,backgroundColor:this.options.color,opacity:this.options.opacity}).addEvent("click",function(){e.fireEvent("click")}).inject(this.container,"top");t.set("morph",{duration:250,transition:"expo:out",link:"cancel"}),t.set("tween",{duration:250,transition:"expo:out",link:"cancel"}),this.masks.push(t)},reach:function(e){if(!e)return;this.el=e;var t=[],n=[],r=this.options.scope.getScrollSize(),i=this.options.offset,s=e.getCoordinates();if(this.options.positionning=="relative"){var o=e.getPosition(this.container);s.left=o.x,s.right=o.x+s.width,s.top=o.y,s.bottom=o.y+s.height}return t=[[0,0,s.left-i,r.y],[0,s.left-i,s.width+i*2,s.top-i],[0,s.right+i,r.x-s.right,r.y],[s.top+s.height+i,s.left-i,s.width+i*2,r.y-s.bottom]],this.masks.each(function(e,n){this._setMaskPosition(e,t[n])},this),this.fireEvent("selected"),this},addClass:function(e){this.masks.each(function(t,n){t.addClass(e)},this)},removeClass:function(e){this.masks.each(function(t,n){t.addClass(e)},this)},_setMaskPosition:function(e,t){e.setStyles({top:t[0],left:t[1],width:t[2],height:t[3]})},set:function(e,t){return selector?self[selector][e](t):this.selectors.each(function(n){self[n][e](t)}),this},setColor:function(e){this._setStyle("backgroundColor",e)},_setStyle:function(e,t){var n=this;return this.masks.each(function(r){n.options.usefx?r.tween(e,t):r.setStyle(e,t)}),this},setStyles:function(e){var t=this;return this.masks.each(function(n){t.options.usefx?n.morph(e):n.setStyles(e)}),this},hide:function(){var e=this;return this.masks.each(function(e){e.setStyle("display","none")}),this},show:function(){var e=this;return this.masks.each(function(e){e.setStyle("display","block")}),this},highlight:function(e){return this.masks.each(function(t){t.highlight(e)}),this},remove:function(){return this.masks.each(function(e){e.destroy()}),this}});return e});
define("UI/Selector/Menu",[],function(){var e=new Class({Implements:[Events,Options],options:{container:document.body,zIndex:200,position:"top left",location:"outside",offset:[1,1],positionning:"absolute"},initialize:function(e,t){this.setOptions(t),this.container=e;var n=this.options.offset;_log.debug("selector-view",this.options),typeOf(n)=="number"?this.offset=[n,n]:this.offset=n,this.menus=[],this._initElement(e)},_initElement:function(e){this.element=(new Element("ul",{"class":"ui-menu type-selector",zIndex:this.options.zIndex})).inject(e),this.fx=new Fx.Morph(this.element,{link:"cancel",duration:250,transition:"expo:out"}),this.element.addEvents({mouseenter:function(e){e.stop()},mouseover:function(e){e.stop()}}),this.options.klss&&this.element.addClass(this.options.klss),this.element.addEvent("click",function(e){e.stop()}),this.buildMenu(this.options.list)},buildMenu:function(e){e.each(function(e){item=(new Element("li",{html:e.text})).set(e.options),e.klss&&item.addClass(e.klss),e.type&&item.addClass("type-"+e.type),this.menus.push(e),e.action&&item.addEvents({click:function(t){t.stop(),e.action()}}),item.inject(this.element)},this)},reach:function(e){if(!e){if(!this.el)return;e=this.el}else this.el=e;var t=this.options,n=this.element.getCoordinates(),r=e.getCoordinates();if(t.positionning=="relative"){var i=e.getPosition(this.options.content);r.left=i.x,r.right=i.x+r.width,r.top=i.y,r.bottom=i.y+r.height}var s="auto",o="auto",u="auto",a="auto";t.position.indexOf("left")>-1&&(o=r.left+this.offset[0]),t.position.indexOf("right")>-1&&(o=r.left+r.width-n.width+this.offset[0]),t.position.indexOf("top")>-1&&(s=r.top),t.position.indexOf("bottom")>-1&&(s=r.top+r.height),t.location=="outside"&&(s=s-n.height-this.offset[1]),t.location=="inside"&&(s+=this.offset[1]),this.options.usefx?this.fx.start({top:s,bottom:u,left:o,right:a}):this.element.setStyles({position:"absolute",top:s,bottom:u,left:o,right:a})},getParent:function(){return this.parent},hide:function(){this.element.hide()},show:function(){this.element.show()}});return e});
define("UI/Selector/Overlay",[],function(){var e=new Class({Implements:[Events,Options],options:{container:document.body,clss:"selector-overlay",offset:"0",styles:{position:"absolute",zIndex:"1000"}},initialize:function(e){this.setOptions(e),this._initElement()},_initElement:function(){var e=this,t="absolute",n;this.element=(new Element("div",{"class":this.options.clss})).setStyles(this.options.styles).setStyle("position",t).addEvents({mouseover:function(e){},click:function(t){t.stop(),clearTimeout(n),n=function(){e.fireEvent("click",e.el),e.hide()}.delay(200,this)},dblclick:function(){clearTimeout(n),e.fireEvent("dblclick")}}).inject(this.options.container,"top")},reach:function(e){this.el=e;var t=this.options.offset,n=e.getCoordinates();this.element.setStyles({"margin-top":n.top-t,"margin-left":n.left-t,width:n.right-n.left+2*t,height:n.bottom-n.top+2*t})},remove:function(){this.element.destroy()},hide:function(){this.element.hide()},show:function(){this.element.show()},highlight:function(e){this.element.highlight(e)}});return e});
define("UI/Selector/Resizer",[],function(){var e=new Class({Implements:[Events,Options],options:{container:document.body,type:"border",clss:"selector-resizer",handler:{size:3},positions:["n","e","s","w"],styles:{display:"none",zIndex:1200,border:"1px solid #71aad3",backgroundColor:"#fff",cursor:"resize",boxSizing:"content-box"}},initialize:function(e,t){this.setOptions(t),this.container=e,this.handlers=[],this.container=e,this._initElement()},_initElement:function(){var e="absolute",t=0;this.options.positions.each(function(e){this.buildHandler(e),t++},this)},buildHandler:function(e){var t=this,n="absolute",r=(new Element("div")).setStyles(this.options.styles).setStyle("position",n).store("position",e).set("class",e).inject(this.container,"top").addEvents({click:function(e){(new Event(e)).stop()},mouseenter:function(e){t.fireEvent("mouseenter",this)},mouseleave:function(e){t.fireEvent("moussleave",this)}});this.handlers.push(r)},reach:function(e){if(!e)return;this.el=e;var t=e.getCoordinates(),n=e.getPosition(this.container);t.top=n.y,t.bottom=n.y+t.height;var r=this.options.handler.size,n=e.getPosition(this.container);t.left=n.x,t.right=n.x+t.width,t.top=n.y,t.bottom=n.y+t.height;var i={nw:[t.top-r,t.left-r],n:[t.top-r,t.right-(t.right-t.left)/2-r],ne:[t.top-r,t.right-r+1],e:[t.bottom-(t.bottom-t.top)/2-r,t.right-r+1],se:[t.bottom-r+1,t.right-r+1],s:[t.bottom-r+1,t.left+(t.right-t.left)/2-r],sw:[t.bottom-r+1,t.left-r],w:[t.top+(t.bottom-t.top)/2-r,t.left-r]};this.handlers.each(function(e){var t=i[e.retrieve("position")];this.setHandlerPosition(e,t)},this)},setHandlerPosition:function(e,t){e.setStyles({"margin-top":t[0],"margin-left":t[1],width:this.options.handler.size,height:this.options.handler.size})},remove:function(){this.handlers.each(function(e){e.destroy()},this)},hide:function(){this.handlers.each(function(e){e.setStyle("display","none")},this)},show:function(){this.handlers.each(function(e){e.setStyle("display","block")},this)}});return e});
define("UI/Selector/Selector",["UI/Selector/Border","UI/Selector/Menu","UI/Selector/Resizer","UI/Selector/Overlay","UI/Selector/Mask"],function(e,t,n,r,i){var s=new Class({Implements:[Events,Options],options:{container:document.body,scope:document.body,target:document.body,trigger:"click",clss:"ui-selector",prefix:"pages",zIndex:1100,wrapper:{tagName:"div",clss:"ui-selector"},components:[],toolbar:!1,menu:!1,border:{size:1,display:"none"},resizer:!0,overlay:!1,cookie:{duration:365,path:"/"},usefx:!1,enable:!0,timerOnHide:0,onCatch:{},onDisable:{},onEnable:{},positionning:"relative"},initialize:function(e){this.setOptions(e),this.selectors=[],this.container=this.options.container;var t=this.options.scope||this.container,n=this.options.target;this.name=this.options.prefix+"-"+this.options.name,this.size={},this.timer=null,this._initElement(this.options.components),this._initEvents(t,n),this.hideNow()},update:function(){var e=this.options.scope,t=this.options.target;this._initEvents(e,t)},_initEvents:function(e,t){var n=this,r=n.options.trigger+":relay("+t+")";e.addEvent(r,function(e,t){n.reach(t)})},attachElement:function(e){var t=this;e.addEvent(t.options.trigger,function(){t.reach(e)}),e.addEvents({mouseenter:function(e){clearTimeout(t.timer)},mouseover:function(e){clearTimeout(t.timer)}})},_initElement:function(e){var t=this;return this.wrapper=(new Element("div",{"class":this.options.wrapper.clss,zIndex:this.options.zIndex})).set("data-selector",this.options.name).inject(this.options.container,"top"),e.each(function(e){t.options[e].content=t.options.container;var n="build"+e.capitalize();t.options[e].usefx||(t.options[e].usefx=t.options.usefx),t.selectors.push(t[n](t.options[e]))}),this.isEnable()?this.enable():this.disable(),this.wrapper},buildComponent:function(){},buildBorder:function(t){var n=this;t.positionning=this.options.positionning,this.border=new e(this.wrapper,t),this.addEvents({show:function(){n.border.show()},hide:function(){n.border.hide()},reach:function(e){n.border.reach(e)},repos:function(e){n.border.reach(e)},highlight:function(e){n.border.highlight(e)}})},buildMask:function(e){var t=this;e.positionning=this.options.positionning,e.scope=this.options.scope,this.mask=new i(this.wrapper,e),this.mask.addEvent("click",function(e){t.fireEvent("click",e)}),this.addEvents({show:function(){t.mask.show()},hide:function(){t.mask.hide()},reach:function(e){t.mask.reach(e)},repos:function(e){t.mask.reach(e)},highlight:function(e){t.mask.highlight(e)}})},buildResizer:function(e){var t=this;this.resizer=(new n(this.wrapper,e)).addEvents({mouseleave:function(){t.hide()},mouseenter:function(){clearTimeout(t.timer)}}),this.addEvents({show:function(e){t.resizer.show()},hide:function(e){t.resizer.hide()},reach:function(e){t.resizer.reach(e)},repos:function(e){t.resizer.reach(e)}})},buildMenu:function(e){var n=this;e.positionning=this.options.positionning,this.menu=new t(this.wrapper,e),this.options.timerOnHide&&this.menu.element.addEvents({mouseleave:function(){n.hide()},mouseenter:function(){clearTimeout(n.timer)}}),this.addEvents({show:function(){n.menu.element.show()},hide:function(){n.menu.element.hide()},reach:function(e){n.menu.reach(e)},repos:function(e){n.menu.reach(e)},highlight:function(e){n.menu.element.highlight(e)}})},buildStatus:function(e){var t=this;this.status=new Status(this.wrapper,e),this.options.timerOnHide&&this.status.element.addEvents({mouseleave:function(){t.hide()},mouseenter:function(){clearTimeout(t.timer)}}),this.addEvents({show:function(){t.status.element.show()},hide:function(){t.status.element.hide()},reach:function(e){t.status.reach(e)},repos:function(e){t.status.reach(e)},highlight:function(e){t.status.element.highlight(e)}})},_initOverlay:function(){var e=this;this.overlay=(new r({container:this.options.container})).addEvents({click:function(){e.fireEvent("click",e.el)},dblclick:function(){e.fireEvent("dblclick",e.el)}}),this.options.timerOnHide&&this.overlay.element.addEvents({mouseleave:function(){clearTimeout(e.timer),e.hide()},mouseenter:function(){clearTimeout(e.timer)}}),this.addEvents({show:function(t){e.overlay.show()},hide:function(t){e.overlay.hide()},reach:function(t){e.overlay.reach(t)},repos:function(t){e.overlay.reach(t)},highlight:function(t){e.overlay.highlight(t)}})},reach:function(e){if(e)this.el=e;else{if(!this.el)return;e=this.el}this.isEnable&&(this.show(),this.fireEvent("reach",e))},repos:function(e){if(e)this.el=e;else{if(!this.el)return;e=this.el}this.isEnable&&(this.show(),this.fireEvent("repos",e))},set:function(e,t,e){var n=this;return e?this[e][e](t):this.selectors.each(function(e){n[e][e](t)}),this},add:function(e){},remove:function(e){},hide:function(){clearTimeout(this.timer),this.timer=function(){this.fireEvent("hide")}.delay(this.options.timerOnHide,this)},hideNow:function(){clearTimeout(this.timer),this.fireEvent("hide")},show:function(){clearTimeout(this.timer),this.isEnable&&this.fireEvent("show")},highlight:function(e){this.isEnable&&this.fireEvent("highlight",e)},enable:function(e){this.isEnable=!0,Cookie.write(this.name,"1",this.options.cookie)},disable:function(e){this.isEnable=!1,Cookie.write(this.name,"0",this.options.cookie),this.hideNow()},isEnable:function(){return Cookie.read(this.name)==="1"?!0:!1},toggle:function(){Cookie.read(this.name)==="1"?this.disable():this.enable()}});return s});
define("UI/Selector/Status",[],function(){var e=new Class({Implements:[Events,Options],options:{container:document.body,type:"status",zIndex:3,clss:"selector-status",position:"top left",location:"outside",offset:[1,1]},initialize:function(e,t){this.setOptions(t);var n=this.options.offset;typeOf(n)=="number"?this.offset=[n,n]:this.offset=n,this._initElement(e)},_initElement:function(e){this.element=(new Element("span",{"class":this.options.clss,zIndex:this.options.zIndex,html:"status"})).inject(e),this.fx=new Fx.Morph(this.element,{link:"cancel",duration:250,transition:"expo:out"})},setStatus:function(e){this.element.set("html",e)},getStatus:function(e){var t=this.options,n="";if(t.dataset){var r=e.dataset[t.dataset],i=r.split(".");i.length>1?n+=n+i[1]:n+=n+i}return t.attr&&(n+=e.get(t.attr)),n},reach:function(e){if(!e){if(!this.el)return;e=this.el}else this.el=e;var t=this.options;this.setStatus(this.getStatus(e)),this.show();var n=this.element.getCoordinates(),r=e.getCoordinates(),i="auto",s="auto",o="auto",u="auto";t.position.indexOf("left")>-1&&(s=r.left+this.offset[0]),t.position.indexOf("right")>-1&&(s=r.left+r.width-n.width+this.offset[0]),t.position.indexOf("top")>-1&&(i=r.top),t.position.indexOf("bottom")>-1&&(i=r.top+r.height),t.location=="outside"&&(i=i-n.height-this.offset[1]),t.location=="inside"&&(i+=this.offset[1]),this.options.usefx?this.fx.start({top:i,bottom:o,left:s,right:u}):this.element.setStyles({position:"absolute",top:i,bottom:o,left:s,right:u})},getParent:function(){return this.parent},hide:function(){this.element.hide()},show:function(){this.element.show()}});return e});
define("UI/Toolbar/Toolbar",["require","exports","module","mnml/icon/app","mnml/icon/font","mnml/icon/mdi","mnml/sys/lang/control/en","mnml/sys/lang/control/fr"],function(e,t,n){var r=e("mnml/icon/app"),i=e("mnml/icon/font"),s=e("mnml/icon/mdi"),o=e("mnml/sys/lang/control/en"),u=e("mnml/sys/lang/control/fr"),a=__debug("core:module-toolbar").defineLevel(),f=new Class({_initToolbar:function(e){a.debug("_initToolbar",e),this.langControl={en:o,fr:u},this.toolbar={},this.control={};if(!e.list){a.warn("missing list field");return}for(var t=0;e.list.length>t;t++){var n=e.list[t],r=e[n];if(!r)continue;if(!this.container[r.container]){if(!r.container)continue;this.container["_init"+r.container.capitalize()]()}var i=this.toolbar[n]=(new Element("div",{"class":"ui-toolbar"})).addEvents({}).inject(this.container[r.container]);r.klss&&i.addClass(r.klss),i.addClass("toolbar-"+n),this._initToolbarComp(r,i)}this.container.fireEvent("resize"),this.fireEvent("toolbarReady")},_initMore:function(){a.debug("_initMore",this.container,this.control.more,this.toolbar.more);if(!this.control||!this.toolbar)return a.warn("missing control or toolbar"),null;var e=null,t=this.toolbar.more,n=this.control.more;if(!n||!t){a.warn("missing control or toolbar",n,t);return}n.addEvent("press",function(e){return a.debug("-- press",e),t.setStyles({display:"inline-block"}),!0}),this.addEvent("control::pressed",function(){t.setStyle("display","none")}),t.addEvents({mouseleave:function(){clearTimeout(e),e=setTimeout(function(){t.setStyle("display","none")},500)},mouseenter:function(){clearTimeout(e)},click:function(){t.setStyle("display","none")}})},_initToolbarComp:function(e,t){a.debug("_initToolbarComp",e,t),e.list=e.list||[];for(var n=0;n<e.list.length;n++){var r=e.list[n],i=e[r];this._instanciateComp(r,i,t)}},_instanciateComp:function(e,t,n){a.debug("_instanciateComp",e,t,n);var r=this,o="UI/Control/Button",u;t=t||{};var f=e.split(/\:\:/);e=f[0],f.splice(0,1);var l=f.join(" ");e==="separator"&&(o="UI/Control/Separator"),t.clss&&(o=t.clss),t.opts?(u=t.opts,u.text=Locale.get("control."+e,e)||e,u.icon=s[t.icon||e]||i[t.icon||e]||"mdi-action-help"):u={name:e,icon:i[t.icon||e]||"mdi-action-help",type:"action",klss:l};if(!e){a.warn("missing name");return}var c;minimal.settings?c=minimal.settings.getLang()||"en":c="en",this.langControl[c]||(c="en");var h;t.text&&(h=this.langControl[c][e]||t.text);if(o==="UI/Control/Button"||o==="UI/Control/ButtonMenu")u.text=this.langControl[c][e]||Locale.get("control."+e,e)||h||e;var p=null;if(!this.sandbox)a.warn("no sandbox");else{var d=this.sandbox.getCurrentUser();d&&d.role&&(p=d.role)}var v=!0;this.options.control=this.options.control||{},this.options.control[p]?this.options.control[p].disallowed?this.options.control[p].disallowed.indexOf(e)>-1&&(v=!1):v=!0:v=!0,v&&(a.debug("require module",e,o,u),this._requireModule(o,function(t){if(!t){a.warn("not found, should require?",e,u);return}r.control[e]=(new t(u)).inject(n);if(e==="more"){r._initMore();return}r.control[e].addEvents({change:function(t){this.isEnable()&&r.fireEvent(e,t)}}),o==="UI/Control/Button"&&r.control[e].addEvents({press:function(){a.debug("press",e),r.fireEvent("control::pressed"),this.isEnable()&&(r.fireEvent("control::"+e,this),r.fireEvent(e,[r]))}}),o==="UI/Control/Upload"&&r.control[e].addEvents({uploadFile:function(t){a.debug("uploadFile",t),this.isEnable()&&r.fireEvent(e,[t])}}),o==="UI/Control/Field"&&r.control[e].addEvents({change:function(){r.fireEvent("control::pressed"),this.isEnable()&&(r.fireEvent("control::"+e,this),r.fireEvent(e,[r]))}}),o==="UI/Control/ButtonMenu"&&r.control[e].addEvents({press:function(e){r.fireEvent("control::pressed"),a.debug("ButtonMenu press",e,this.isEnable()),this.isEnable()&&(r.fireEvent("control::"+e,this),r.fireEvent(e,[r]))}})}))},_requireModule:function(t,n){a.debug("_requireModule",t);if(typeOf(t)==="class"){n(t);return}e([t],function(e){n(e)},function(e){a.error(t,e),n()})}});n.exports=f});
define("UI/View/Container",["UI/Container/Container","UI/Window/Window"],function(e,t){var n=__debug("core-view-container").defineLevel(),r=new Class({options:{containers:{dispose:!0}},_initContainer:function(){n.debug("_initContainer",this.container);var r=this.options,i=this,s=typeOf(r.container);if(s==="object")this.container.addEvent("resize",function(){i.fireEvent("resize")});else if(s==="element")this.container=new e({container:r.container});else if(r.window){var o=new t(r.window);this.content=o.body,this.element=o.body,this.element.addClass("view-"+r.clss),this.container=o,this.container.addEvent("resize",function(){i.fireEvent("resize")})}this.content||this._initContent(),this.addEvents({focus:function(){i.container.setState("focus")},blur:function(){i.container.setState()}})},addContainer:function(t){var n=this,r=this.options.view,i=t||this.index,s=(new e(r)).inject(this);return n.addEvent("resize",function(){s.fireEvent("resize")}),this.views.length===0&&(this.index=0),s.addClass("view"+i),this.views[i]=s,this.fireEvent("added",s),t||(this.view=s),s},moveTo:function(e){var t=this.options;return this.index=e,this.last=this.view,this.views[e]?(this.view=this.views[e],t.containers.dispose?(this.view.element.inject(this.element),this.fireEvent("updateWeekCell")):this.view.element.show()):this.view=this.addContainer(e),t.containers.dispose?this.last.element.dispose():this.last.element.hide(),this.view},next:function(e){e=e||1;var t=this.index+e;this.moveTo(t,1)},back:function(e){e=e||1;var t=this.index-e;this.moveTo(t,-1)}});return r});
define("UI/View/Dragging",[],function(){var e=new Class({_initDragging:function(e,t){e=this.element;var n,r,i,s,o,u=function(){var t=Date.now();s=[e.scrollLeft,e.scrollTop];if(n){var o=t-n+1;i=[1e3*(s[0]-r[0])/o,1e3*(s[1]-r[1])/o]}r=s,n=t},a=this.fxdrag=new Fx.Scroll(e,{transition:Fx.Transitions.Expo.easeOut});a.set.apply(a,this.limit(e.scrollLeft,e.scrollTop));var f=this,l=this.options.friction,c=this.options.axis,h=this.drag=new Drag(e,{style:!1,invert:!0,handlers:[],modifiers:{x:c.x&&"scrollLeft",y:c.y&&"scrollTop"},onStart:function(){u(),o=setInterval(u,1e3/60),a.cancel()},onDrag:function(){},onComplete:function(){n=!1,clearInterval(o)}})}});return e});
define("UI/View/Layout",["UI/Layout/Layout"],function(e){var t=__debug("view:core-layout"),n=new Class({_initLayout:function(n){t.debug("_initLayout");var r=n||this.options,i=this;this.device=r.device;if(!r.layout)return;var s=r.settings.layout,o=this.layout=(new e({theme:r.theme,container:r.container,node:r.layout,settings:s})).addEvents({resizer:function(e,t,n){i.setSettings("layout."+e+"."+t,n)},display:function(e,t){i.setSettings("layout."+e+".display",t)}});this.container=this.layout.container,this.container.addClass("app-"+this.options.name)}});return n});
define("UI/View/Limit",[],function(){var e=new Class({getLimit:function(){var e=[[0,0],[0,0]],t=this.element;return e[0][0]=0,e[0][1]=e[0][0]-t.clientWidth,e[1][0]=0,e[1][1]=e[1][0]-t.clientHeight,e},limit:function(e,t){var n=this.getLimit();return[e.limit(n[0][0],n[0][1]),t.limit(n[1][0],n[1][1])]}});return e});
define("UI/View/Loader",[],function(){var e=new Class({_initLoader:function(){var e=this;this.addEvents({getData:function(){e.showLoader()},noData:function(){e.hideLoader()},setList:function(){e.hideLoader()},progress:function(t,n){e.loader&&e.loaderText.set("html","Loading: "+t)}})},showLoader:function(){var e=this;this.content.empty(),this.element.scrollTop=0,this.length=0,this.list=[],this.docs=[],this.setStatus("Loading..."),clearTimeout(this.loaderTimeout),this.loaderTimeout=setTimeout(function(){if(e.content&&!e.content.childNodes.length)var t=e.loader=(new Element("div",{"class":"ui-loader"})).inject(e.content),n=e.loaderText=(new Element("span",{html:"Loading...","class":"loader-text"})).inject(t,"top"),r=(new Element("div",{"class":"loader-bar"})).inject(t,"bottom")},200)},hideLoader:function(){clearTimeout(this.loaderTimeout),this.loader=null,this.content.empty(),this.setStatus("0 Results"),this.element.scrollTop=0,this.length=0,this.list=[],this.docs=[]}});return e});
define("UI/View/Scroll",[],function(){var e=__debug("core-view-scroll").defineLevel(),t=new Class({_initAutoScroll:function(){this.scroll=new Fx.Scroll(this.element,this.options.autoScrollOptions)},_initScroll:function(e){var t=this.options;t.scroller&&this._initScroller(t.scroller)},_initScrollbar:function(){var e=this,t={};t.container=this.element,this.scrollbar=(new UI.Scroll(t)).addEvent("scrolling",function(){e.fireEvent("scrolling")}),this.addEvents({loadCompplete:function(){e.scrollbar.update()},resize:function(){e.scrollbar.update()}})},_initScroller:function(){return this.scroller=(new Scroller(this.element,this.options.scroller_opts)).addEvent("change",function(){e.debug("scroller change")}),this}});return t});
define("UI/View/View",["require","exports","module","./ctrl","UI/Container/Container","UI/Layout/Layout","UI/Toolbar/Toolbar","UI/Component/Binding","./Container","./Dragging","./Limit","./Loader","./Scroll","./Layout","./Zoom"],function(e,t,n){var r=e("./ctrl"),i=e("UI/Container/Container"),s=e("UI/Layout/Layout"),o=e("UI/Toolbar/Toolbar"),u=e("UI/Component/Binding"),a=e("./Container"),f=e("./Dragging"),l=e("./Limit"),c=e("./Loader"),h=e("./Scroll"),p=e("./Layout"),d=e("./Zoom"),v=__debug("view").defineLevel(),m=new Class({Implements:[Events,Options,u,o,a,f,l,c,h,p,d],options:{lib:"minimal",base:"view",clss:"view",content:!0,friction:5,tag:"div",node:{name:"container"},axis:{x:!0,y:!0},range:[10,52],fx:{transition:Fx.Transitions.Quart.easeOut,duration:240,wait:!1},scrollbar:null,scroll:"scrollbar",dragging:null,scroller:null,scroller_opts:{area:160,velocity:.5},autoScrollOptions:{wait:!1,duration:200,offset:{x:0,y:-50},transition:Fx.Transitions.Quad.easeInOut},controller:{_list:[]}},initialize:function(e){return v.debug("initialize",e),e=e||{},e.sandbox&&(this.sandbox=e.sandbox,delete e.sandbox),e.connector&&(this.connector=e.connector,e.connector=!0),e.collection&&(this.collection=e.collection,e.collection=!0),e.onSettings&&(this.onSettings=e.onSettings,e.onSettings=!0),this.setOptions(e),this.opts=this.options,this.container=e.container,this._init(),this},_init:function(e){e=this.opts,this.index=0,this.views=[],this._initContainer(),e.toolbar&&this._initToolbar(e.toolbar),e.menus&&this._initMenus(),this._initEvents(),e.scroller&&this._initScroller(),this._initView(),r.register(this),this.fireEvent("initReady")},_initView:function(){v.debug("_initView"),this.isOpen=!0,this.visible=!0},_init__Options:function(e){return this.main=e.main||e.name,ui.node=ui.node||{},ui.node[this.main]=ui.node[this.main]||{},this.layout=e.layout||{},this.layout[this.main]=this.layout[this.main]||{},this.dragHandlers=e.dragHandlers||[],this},_initContent:function(){var e=this.options;this.fireEvent("create");var t=new Element(e.tag,{"class":this.klass,styles:e.styles,events:e.events,id:e.id,name:e.name,html:e.html});t.addClass("container-body"),this.element=t,this.content=t,t.store("_instance",this),this.fireEvent("created"),e.container&&e.container!=="window"&&this.element.inject(this.container),e.resizable&&this._initResizer(),this._initClass()},focus:function(){v.debug("focus"),r.focus(this),this.fireEvent("focus"),this.fireEvent("render")},_initLayout:function(e){v.debug("_initLayout",e);var t=this.options;this.container=new i({container:t.container,name:t.name,node:t.layout||t.node}),this.layout=new s({container:this.container,layout:t.layout}),this.container=this.layout.container},_initConnector:function(){v.debug("_initConnector");var e=this.opts;this.conn=e.conn,this.conn.addEvents({ready:function(e){}})},_connect:function(e){v.debug("_connect",e);var t=this;if(!e){v.warn("missing conn");return}this.data=e,this.data.get(),this.data.addEvents({ready:function(e){t.fireEvent("dataReady",e)}})},_initModules:function(t,n){e(t,function(){n()})},_initEvents:function(){v.debug("_initEvents");var e=this.options;this.fx=new Fx.Scroll(this.element,this.options.fx),this._initLoader&&this._initLoader(),e.dragging&&this._initDragging();if(!e.container)return},_initClass:function(){var e=this.options;this.element.addClass(e.lib+"-"+e.base),this.element.addClass(e.base+"-"+e.clss),e.klss&&this.element.addClass(e.klss)},remove:function(e){e.destroy&&e.destroy()},setTitle:function(e){v.debug("setTitle",e);var t=this;return function(){t.control.title&&t.control.title.set(e)}.delay(200),this},getTitle:function(){return this.container.getTitle()},setStatus:function(e){v.debug("setStatus",e),this.control&&this.control.status&&this.control.status.element.set("html",e)},isVisible:function(){return this.visible},clear:function(){this.content&&this.content.empty&&this.content.empty()},close:function(){return this.container.close(),this},_initStatus:function(){},_initData:function(){},hide:function(){v.debug("hide"),this.container.hide(),this.visible=!1},show:function(){v.debug("show"),this.container.setStyle("display",null),this.visible=!0}});n.exports=m});
define("UI/View/Zoom",[],function(){var e=new Class({_initZoom:function(){},zoomIn:function(){var e=this;this.zf||(this.zf=.7);if(this.zf>1.6)return;this.zf=e.zf.toFloat()+.1;var t=this.zf+.1;lhem=t.toString()+"em";var n=this.zf.toString()+"em";this.element.setStyle("font-size",n),this.element.setStyle("line-height",lhem),this.fireEvent("resize")},zoomOut:function(){var e=this;this.zf||(this.zf=.7);if(this.zf<.5)return;this.zf=e.zf.toFloat()-.1;var t=this.zf+.1;lhem=t.toString()+"em",em=this.zf.toString()+"em",this.element.setStyle("font-size",em),this.element.setStyle("line-height",lhem),this.fireEvent("resize")}});return e});
define("UI/View/ctrl",[],function(){var e={list:[],register:function(e,t){this.list.push(e);return},focus:function(e,t){if(e===null)return;this.active!==e&&(this.active&&this.blur(this.active),this.active=e,e.fireEvent("focus"));return},blur:function(e){e.fireEvent("blur",e);return}};return e});
define("UI/Window/Dialog",["UI/Control/Button","UI/Window/Window"],function(e,t){var n=new Class({Extends:t,name:"dialog",options:{center:!0,title:"Dialog",type:"dialog",alert:!1,width:480,height:200,location:"center",zIndex:6e3,modal:!0,foot:{"class":"ui-foot"},controls:["minimize","maximize","close"],control:{_list:["cancel","ok::is-primary"]},useOverlay:!1},initialize:function(e){this.parent(e)},_initElement:function(){this.parent(),this._initBody(),this._initActions()},_initBody:function(){var e=this.options.message;this.message=(new Element("div",{"class":"container-body",styles:{padding:"16px"},html:e})).inject(this.foot,"before")},_initMessage:function(e){},_initActions:function(){var e=this;this.actions=this.actions||[];var t=(new Element("div",{"class":"ui-toolbar toolbar-action"})).inject(this.foot);if(this.options.alert){var n=this.options.control._list,r=n.indexOf("cancel");r>-1&&n.splice(r,1)}var i=this.options.control||{},n=i._list||[];for(var s=0;s<n.length;s++){var o=n[s],u=i[o];e._initAction(o,u,t)}},_initAction:function(t,n,r){var i=this,s=t.split("::"),t=s[0],o=s[1],u=(new e({name:t,text:t,klss:o})).addEvent("press",function(e){i.fireEvent(t),i.close()}).inject(r);this.actions.push(u)}});return n});
define("UI/Window/Prompt",["UI/Component/Text","UI/Control/Button","UI/Window/Window"],function(e,t,n){var r=new Class({Extends:n,name:"prompt",options:{center:!0,title:"Prompt",type:"prompt",width:480,height:200,location:"center",zIndex:6e3,modal:!0,foot:{"class":"ui-foot"},controls:["minimize","maximize","close"],control:{_list:["cancel","ok::is-primary"]},useOverlay:!1},initialize:function(e){this.parent(e),this.message.focus()},_initElement:function(){this.parent(),this._initBody(),this._initActions()},_initHead:function(t){this.parent(t),this.title=(new e({type:"title",text:this.options.title})).inject(this.head)},_initBody:function(){var e=this;this.message=(new Element("textarea",{"class":"ui-prompt"})).inject(this.foot,"before"),this.addEvents({ok:function(){var t=e.message.get("value");e.fireEvent("confirm",t)}})},_initActions:function(){var e=this;this.actions=this.actions||[];var t=(new Element("div",{"class":"ui-toolbar toolbar-action"})).inject(this.foot),n=this.options.control||{},r=n._list||[];for(var i=0;i<r.length;i++){var s=r[i],o=n[s];e._initAction(s,o,t)}},_initAction:function(e,n,r){var i=this,s=e.split("::");e=s[0];var o=s[1],u=(new t({name:e,text:e,klss:o})).addEvent("press",function(){i.fireEvent(e),i.close()}).inject(r);this.actions.push(u)}});return r});
define("UI/Window/Window",["UI/Window/controller","UI/Container/Container","UI/Control/Button"],function(e,t,n){var r=new Class({Extends:t,name:"window",options:{name:"window",title:"Window",container:$(document.body),context:"top",content:!0,width:220,height:360,location:"cascade",position:"fixed",zIndex:"auto",tag:"div",head:!0,view:{},foot:{"class":"ui-foot"},controls:["minimize","maximize","close"],useEffects:!1,focus:!0,draggable:!0,dragHandlers:["head","foot"],useUnderlay:!0,useOverlay:!0,hideOnDrag:!0,resizable:!0,resizeLimitX:[160,screen.width],resizeLimitY:[260,screen.height],resizeOnDragIfMaximized:!1,resizeBorders:["top","right","bottom","left"]},initialize:function(e){this._initController(),this.parent(e),this._initLocation(),this.adaptLocation(),this.options.position=="fixed"&&this.element.setStyle("position","fixed"),ui.window.register(this),this.options.focus&&ui.window.focus(this),window.onresize=function(e){ui.window.resetMinimized()},this.inject(this.options.container)},_initController:function(){ui.window||(this.controller=ui.window=e,ui.window.init())},_initElement:function(){this.parent(),this._initControl(this.options.controls)},_initShim:function(){this.shim=(new Element("iframe",{src:'javascript:false;document.write("");',scrolling:"no",frameborder:0,styles:{top:0,left:0,zIndex:"1",position:"absolute",border:"none",filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"},"class":"iframeShim"})).inject(this.element,"top").store("IframeShim",this)},_initHead:function(e){this.parent(e),this.dragHandlers.push(this.head)},_initControl:function(){return;var e,t},_initBody:function(e){this.fireEvent("resize"),this.body=(new Element("div")).addClass("container-body").inject(this.element),this.addEvents({minimize:function(){this.body.hide()},normalize:function(){this.body.show()}})},_initFoot:function(e){this.parent(e),this.dragHandlers.push(this.foot),this.addEvents({minimize:function(){this.body.hide()},normalize:function(){this.body.show()}})},setTitle:function(e){return},_initClass:function(){this.parent(),this.element.addClass("ui-window")},_initEvents:function(){this.parent();var e=this;this.addEvents({onFocus:function(){},injected:function(){e.adaptLocation()},onResizeStart:function(){},onResizeComplete:function(){this.coord=this.element.getCoordinates()},onDragStart:function(){},onDragComplete:function(){this.coord=this.element.getCoordinates()},resizeComplete:function(){e.maximized=!1,this.coord=this.element.getCoordinates()}}),this.element.addEvents({mousedown:function(){e.focus()}}),this.resizeHandlers&&this.resizeHandlers.each(function(e){e.addEvents({mousedown:function(){},mouseup:function(){}})})},_initUnderlay:function(){var e=this,t=this.options.container||$(document.body);this.underlay=(new Element("div",{"class":"dialog-underlay",styles:{zIndex:900}})).inject(t),this.underlay.addEvents({mousedown:function(){e.element.addClass("reveal-window")},mouseup:function(){e.element.removeClass("reveal-window")}}),this.underlay.show(),this.addEvent("close",function(){e.underlay.destroy()})},focus:function(){this.minimized?(this.normalize(),ui.window.resetMinimized()):this.maximized&&this.options.resizeOnDragIfMaximized?this.normalize():ui.window.focus(this),this.state!="default"&&this.setState("default")},control:function(e){return this[e](),this},minimize:function(){this.fireEvent("minimize"),this.disableDrag(),this.coord=this.element.getCoordinates(),this.maximized=!1,this.minimized=!0,this.setState("minimized");var e=ui.window.getcoord("minimized");this.element.setStyles(e),ui.window.focus()},maximize:function(){return this.maximized?this.normalize():(this.coord=this.element.getCoordinates(),this.max=this.container.getCoordinates(),this.setState("maximized"),this.setStyles({position:"absolute",width:"100%",height:"100%",top:0,left:0,right:0,bottom:0}),this.minimized=!1,this.maximized=!0),this},normalize:function(){var e=this;return this.fireEvent("normalize"),this.element.setStyles(this.coord),this.setState("default"),this.maximized=!1,this.minimized=!1,function(){e.enableDrag()}.delay(1e3),this},storeCoordinates:function(){this.coord=this.element.getCoordinates()},close:function(){return ui.window.close(this),this.fireEvent("closed"),this}});return r});
define("UI/Window/controller",[],function(){var e={options:{version:"0.1",zBase:1e3,zStep:2,container:document.body,cascade:{start:{x:51,y:101},step:{x:20,y:20},offset:[170,50]},stack:{offset:{x:16,y:16}},underlay:{},minimized:{coord:{width:160,height:50,bottom:-10,left:32,offset:{x:16}}},maximized:{coord:{width:960,height:760,top:"auto",left:"auto"}},normalized:{coord:{width:220,height:360,bottom:10,top:"auto",left:""}}},init:function(e){this.container=e,this.list=[],this.zIndex=this.options.zBase,this.group={},window.addEvent("resize",function(){this.resizeMaximizedWindow()}.bind(this))},register:function(e,t){this.list.push(e),t&&(this.group[t]&&(this.group[t]=[]),this.group[t].push(e)),e.options.zIndex==="auto"?(e.element.setStyle("zIndex",this.zIndex),e.altitude=this.zIndex):e.element.setStyle("zIndex",e.options.zIndex),this.zIndex+=this.options.zStep},close:function(e){e=e||this.active,e.hide(),e.fireEvent("onClose");for(var t=this.list.length-1;t>=0;t--)this.list[t]==e&&(e.destroy(),delete this.list[t],this.list=this.list.clean());this.focus()},focus:function(e){if(e===null){var t=0;for(var n=this.list.length-1;n>=0;n--){var r=this.list[n].element.getStyle("zIndex");r>=t&&!this.list[n].minimized&&(e=this.list[n],t=r)}e&&e.focus();return}if(e&&this.active!==e){this.active&&!this.active.minimized&&this.blur(this.active),this.zIndex+=this.options.zStep,e.element.style.zIndex=this.zIndex,e.element.style.zoom="1",this.active=e,e.fireEvent("focus"),e.grid&&this.list.each(function(t){e.setStyles(coord)});return}},blur:function(e){e!==null&&!e.minimized?(e.setState("inactive"),e.fireEvent("onBlur")):this.active&&this.blur(this.active)},minimize:function(e){var t=e||this.active;t.minimize()},getcoord:function(e){var t=this.options,n=0,r=t[e].coord;return n+=r.left,this.list.each(function(t,i){t.state===e&&(n+=r.width+r.offset.x)}),{width:r.width,height:r.height,bottom:r.bottom,top:"auto",left:n}},resetMinimized:function(){var e="minimized",t=ui.window.options,n=t[e].coord,r=0,i=n.bottom;this.list.each(function(e,t){e.state==="minimized"&&(r+=n.width+n.offset.x,e.setLocation(r,i))})},resizeMaximizedWindow:function(){this.list.each(function(e){e.state==="maximized"&&e.setSize({height:window.getHeight()-32,width:window.getWidth()})})},getCascadeLocation:function(e){var t={left:71,top:121};return this.list.each(function(e,n){e.state!="minimized"&&e.options.location=="cascade"&&(t.left+=this.options.cascade.step.x,t.top+=this.options.cascade.step.y)},this),t},cascade:function(e){var t=[51,101],n=[20,20],r=this.zIndex,i,s=[];e?s=this.group:s=this.list,s.each(function(e){if(e.state==="minimized")return;e.element.style.zIndex=r++,t[0]+=n[0],t[1]+=n[1],e.element.morph({left:t[0],top:t[1]}),e.location="cascade",i=e}),this.zIndex=r},circle:function(e){var t=[200,300],n=[],r=200,i=this.zIndex,s=1,o=this.list.length;this.list.each(function(e){e.element.style.zIndex=i++,e.element.style.zoom="1";var u=s/o*2;n[0]=Math.cos(u*Math.PI),n[1]=Math.sin(u*Math.PI);var a=t[0]+n[0]*r,f=t[1]+n[1]*r;s++,e.element.morph({top:f,left:a}),e.adaptLocation(),e.location="circle"}),this.zIndex=i},grid:function(e){var t=[160,240],n=[100,100],r=[20,20],i=this.zIndex,s=0,o=0,u={},a=this.list.length;this.list.each(function(e,a){e.element.style.zIndex=i++,e.coord=e.getCoordinates(),u.left=n[0]+(r[0]+t[0])*o,u.left>1e3&&(u.left=n[0],s++,o=0),u.top=n[1]+(r[1]+t[1])*s,u.width=t[0],u.height=t[1],e.element.morph(u),o++,e.adaptLocation(),e.location="grid"}),this.zIndex=i},closeall:function(){this.list.each(function(e){this.close(e)},this)},buildunderlay:function(e){var t=this.options.underlay;this.underlay=(new Element("div",{"class":"ui-underlay"})).inject(this.container),this.underlay.hide()},showunderlay:function(e){this.underlay.setStyles({display:"block",zIndex:e.altitude})}};return e});
(function(e,t){typeof define=="function"&&define.amd?define("UI/utils/api",[],t):typeof exports=="object"?module.exports=t():e.returnExports=t()})(this,function(){var e={_pathTo:function(e,t){if(typeOf(e)==="function")return e;var n=e.split("."),r=null,i=null;for(var s=0;s<n.length;s++){var o=n[s];r=r||t,r=r[o],i=i||t,typeof i[o]!="function"&&(i=i[o])}return{func:r,context:i}},deref:function(e,t){var n=0;t=t.split(".");while(e&&n<t.length)e=e[t[n++]];return e},strToClss:function(e){if(typeOf(e)==="class")return e;var t=e.split("."),n=null;for(var r=0;r<t.length;r++){var i=t[r];n?n=n[i]:n=window[i]}return n},toclss:function(e){if(typeOf(e)==="class")return e;var t=e.split("."),n=null;for(var r=0;r<t.length;r++){var i=t[r];n?n=n[i]:n=window[i]}return n}};return e});
define("UI/utils/debug",["https://rawgit.com/jonnyreeves/js-logger/master/src/logger.min.js"],function(e){function n(e,t){if(e)t={debug:window.console.info.bind(window.console,"%s"),info:window.console.info.bind(window.console,"%s"),warn:window.console.warn.bind(window.console,"%s"),error:window.console.error.bind(window.console,"%s"),fatal:window.console.error.bind(window.console,"%s")};else{var n=function(){};t={debug:n,info:n,warn:n,error:n,fatal:n}}}var t=t||{log:function(){}};window._log={debug:window.console.info.bind(window.console,"%s"),info:window.console.info.bind(window.console,"%s"),warn:window.console.warn.bind(window.console,"%s"),error:window.console.error.bind(window.console,"%s"),fatal:window.console.error.bind(window.console,"%s")},e.useDefaults(),window.__debug=function(t){t=t||"minimal";var n=e.get(t);return n.setLevel(e.WARN),n.warn=window.console.warn.bind(window.console,"["+t+"] %s"),n.error=window.console.error.bind(window.console,"["+t+"] %s"),n.fatal=window.console.error.bind(window.console,"["+t+"] %s"),n.defineLevel=function(n){e.get(t).setLevel(e[n])},n},n(!0,window._log)});